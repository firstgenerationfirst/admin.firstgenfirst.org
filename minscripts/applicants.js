"use strict";function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a,n=arguments[t];for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,s=[],l=!0,o=!1;try{for(a=a.call(e);!(l=(n=a.next()).done)&&(s.push(n.value),!t||s.length!==t);l=!0);}catch(e){o=!0,i=e}finally{try{l||null==a.return||a.return()}finally{if(o)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(t,e){var a,n=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){_defineProperty(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _get(e,t,a){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,a){e=_superPropBase(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(a):t.value}})(e,t,a||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(a){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(a);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(a="Object"===a&&e.constructor?e.constructor.name:a)||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}!function(){function _(t){return{onKeyPress:function(e){"Space"!=e.code&&"Enter"!=e.code&&"Space"!=e.key&&"Enter"!=e.key||(e.stopPropagation(),e.preventDefault(),t(e))},onClick:function(e){e.stopPropagation(),e.preventDefault(),t(e)}}}var e,ee=window.applicant_spreadsheets,m=ee.MISSING_FIELD,te=ee.Enum.NA,l=["applicant","finalist","recipient","ineligible","2nd read"],y=/^[^a-zA-Z\d]*$/,o=/(?:\s+|^)status\s*[:=]\s*([a-z\d]+)(?=\s+|$)/,r=/(?:\s+|^)(?:#?(\d+)\s*-\s*([a-f\d]*)|#([a-f\d]+)|([a-f\d]*\d[a-f\d]*))(?=\s+|$)/,s={},t=_createForOfIteratorHelper(document.cookie.split("; "));try{for(t.s();!(e=t.n()).done;){var a=_slicedToArray(e.value.split("="),2),n=a[0],i=a[1];s[decodeURIComponent(n)]=decodeURIComponent(i)}}catch(e){t.e(e)}finally{t.f()}var c=[],ae=!1,p=!1;user.readProfile.then(function(e){c=e.roles,ae=c.includes("applicant_editor"),p=c.includes("applicant_voting_master")});var u=firebase.firestore(),d=u.collection("applicants").doc("voting"),Y=u.collection("applicants").doc("voting_poll"),z={active:!1,poll:null,poll_receivers:[]};function h(e,t){return isNaN(e)?e:e%1e3==0&&0!=e?(t||"")+(e/1e3).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")+"k":(t||"")+e.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}function g(e){return h(e,"$")}function f(e){return e.trim().replace(/\s+/g," ").toLocaleLowerCase(navigator.language).replace(/([^0-9A-Za-zÀ-ÖØ-öø-ÿ]+(?!(?:the|a|an|at|and|but|or|for|nor|as|if|in|on|of)\b)|^|[^0-9A-Za-zÀ-ÖØ-öø-ÿ]](?=[0-9A-Za-zÀ-ÖØ-öø-ÿ]+$))([0-9A-Za-zÀ-ÖØ-öø-ÿ])/g,function(e,t,a){return t+a.toLocaleUpperCase(navigator.language)})}function E(t){return function(e){return e==te?"N/A":t(e)}}var v,R={alabama:"AL",alaska:"AK",arizona:"AZ",arkansas:"AR",california:"CA",colorado:"CO",connecticut:"CT",delaware:"DE",florida:"FL",georgia:"GA",hawaii:"HI",idaho:"ID",illinois:"IL",indiana:"IN",iowa:"IA",kansas:"KS",kentucky:"KY",louisiana:"LA",maine:"ME",maryland:"MD",massachusetts:"MA",michigan:"MI",minnesota:"MN",mississippi:"MS",missouri:"MO",montana:"MT",nebraska:"NE",nevada:"NV","new hampshire":"NH","new jersey":"NJ","new mexico":"NM","new york":"NY","north carolina":"NC","north dakota":"ND",ohio:"OH",oklahoma:"OK",oregon:"OR",pennsylvania:"PA","rhode island":"RI","south carolina":"SC","south dakota":"SD",tennessee:"TN",texas:"TX",utah:"UT",vermont:"VT",virginia:"VA",washington:"WA","west virginia":"WV",wisconsin:"WI",wyoming:"WY"},b=Object.values(R),A=new RegExp("^(.+?)(?:(?:,\\s*|\\s+)(".concat(Object.keys(R).join("|"),"))?$")),ne={First:E(f),Last:E(f),Email:E(function(e){return e.toLocaleLowerCase(navigator.language)}),Status:E(function(e){var t={};return _defineProperty(t,ee.Enum.STATUS.APPLICANT,"Applicant"),_defineProperty(t,ee.Enum.STATUS.FINALIST,"Finalist"),_defineProperty(t,ee.Enum.STATUS.RECIPIENT,"Recipient"),_defineProperty(t,ee.Enum.STATUS.INELIGIBLE,"Ineligible"),_defineProperty(t,ee.Enum.STATUS.SECOND_READ,"2nd Read"),t[e]||"N/A"}),Income:E(function(e){return Array.isArray(e)?"Infinity"==e[1]?"".concat(g(e[0]),"+"):"".concat(g(e[0]),"–").concat(g(e[1])):g(e)}),Members:E(h),EFC:E(function(e){return"number"==typeof e?g(e):+e==+ee.Enum.EFC.UNDOCUMENTED?"Undocumented":+e==+ee.Enum.WRITE_IN?e.value:"N/A"}),College:E(function(e){return e=({Stanford:"Stanford University","Uc Los Angeles":"UCLA",Ucsd:"UC San Diego",Ucsb:"UC Santa Barbara",Ucsc:"UC Santa Cruz",Ucr:"UC Riverside",Ucm:"UC Merced",Ucd:"UC Davis",Ucb:"UC Berkeley",Berkeley:"UC Berkeley",Uci:"UC Irvine",Csun:"CSU Northridge","Rio Hondo":"Rio Hondo College",Ivc:"Irvine Valley College",Lbcc:"Long Beach City College",Iupui:"Indiana University–Purdue University Indianapolis",Umkc:"University of Missouri–Kansas City"}[e=f(e).replace(/\bU\b/,"University")]||e).replace(/\b(?:uc|ucla|csu|su|cn|cc|usc|ca)\b/gi,function(e){return e.toLocaleUpperCase(navigator.language)})}),Loans:E(function(e){var t={};return _defineProperty(t,ee.Enum.LOANS.YES,"Yes"),_defineProperty(t,ee.Enum.LOANS.NO,"No"),_defineProperty(t,ee.Enum.LOANS.UNCERTAIN,"N/A"),t[e]||"N/A"}),Campus_Living:E(function(e){var t={};return _defineProperty(t,ee.Enum.CAMPUS_LIVING.ON_CAMPUS,"On campus"),_defineProperty(t,ee.Enum.CAMPUS_LIVING.OFF_CAMPUS_RENT,"Off campus w/ rent"),_defineProperty(t,ee.Enum.CAMPUS_LIVING.OFF_CAMPUS_NO_RENT,"Off campus w/o rent"),_defineProperty(t,ee.Enum.CAMPUS_LIVING.UNCERTAIN,"Unknown"),t[e]||"N/A"}),Location:E(function(e){if("washington dc"==(e=e.toLowerCase().trim()).replace(/[^a-z\d\s]/g,""))return"Washington, DC";if(b.includes(e.substring(e.length-2).toUpperCase())&&e.substring(0,e.length-2).trim().length!=e.length-2){var t=e.substring(e.length-2);return","!=(e=e.substring(0,e.length-2).trim())[e.length-1]&&(e+=","),f(e)+" "+t.toUpperCase()}return e.replace(A,function(e,t,a){return f(t)+(a?", "+R[a]:"")})}),Year:E(function(e){var t={};return _defineProperty(t,ee.Enum.YEAR.HIGH_SCHOOL,"High school student"),_defineProperty(t,ee.Enum.YEAR.FIRST_YEAR,"First year college student"),_defineProperty(t,ee.Enum.YEAR.COLLEGE,"Returning college student"),_defineProperty(t,ee.Enum.YEAR.GRADUATE,"Graduate student"),_defineProperty(t,ee.Enum.YEAR.TRANSFER,"Transfer student"),t[e]||"N/A"}),Parent1_Education:E(function(e){var t={};return _defineProperty(t,ee.Enum.PARENT1_EDUCATION.NO_DIPLOMA,"No diploma"),_defineProperty(t,ee.Enum.PARENT1_EDUCATION.DIPLOMA,"HS diploma or equivalent"),_defineProperty(t,ee.Enum.PARENT1_EDUCATION.SOME_COLLEGE,"Some college"),_defineProperty(t,ee.Enum.PARENT1_EDUCATION.DEGREE,"College degree"),_defineProperty(t,ee.Enum.PARENT1_EDUCATION.MULTIPLE_DEGREES,"Multiple degrees"),_defineProperty(t,ee.Enum.PARENT1_EDUCATION.NO_PARENT,"No parent 1"),t[e]||"N/A"}),Parent2_Education:E(function(e){var t={};return _defineProperty(t,ee.Enum.PARENT2_EDUCATION.NO_DIPLOMA,"No diploma"),_defineProperty(t,ee.Enum.PARENT2_EDUCATION.DIPLOMA,"HS diploma or equivalent"),_defineProperty(t,ee.Enum.PARENT2_EDUCATION.SOME_COLLEGE,"Some college"),_defineProperty(t,ee.Enum.PARENT2_EDUCATION.DEGREE,"College degree"),_defineProperty(t,ee.Enum.PARENT2_EDUCATION.MULTIPLE_DEGREES,"Multiple degrees"),_defineProperty(t,ee.Enum.PARENT2_EDUCATION.NO_PARENT,"No parent 2"),t[e]||"N/A"}),Phone:E(function(e){return 12==(e=e.replace(/[^\d\+]+/g,"")).length&&"+1"==e.substring(0,2)?e=e.substring(2):11==e.length&&"1"==e.substring[0]&&(e=e.substring(1)),10!=e.length||isNaN(e)?"N/A":"(".concat(e.substring(0,3),") ").concat(e.substring(3,6),"-").concat(e.substring(6,10))}),Birthday:E(function(e){return!isNaN(e.valueOf())&&e<new Date?"".concat(["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."][e.getMonth()]," ").concat(e.getDate(),", ").concat(e.getFullYear()):"N/A"}),Pronouns:E(function(e){return e.split("/").map(function(e){return f(e.trim())}).join("/")})},S=[];for(v in ee)isNaN(v)||S.push(v);S.sort(function(e,t){return t-e});var k=function(){_inherits(i,React.Component);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"setNestedState",value:function(e,t){var a,n={};for(a in e)n[a]="object"==_typeof(e[a])&&null!==e[a]&&e[a]!=this.state[a]?this.__extendStateObj(e[a],"object"==_typeof(this.state[a])&&null!==this.state[a]?this.state[a]:{},t||10):e[a];return _get(_getPrototypeOf(i.prototype),"setState",this).call(this,n)}},{key:"__extendStateObj",value:function(e,t,a){for(var n in e)t[n]="object"==_typeof(e[n])&&null!==e[n]&&0<a?this.__extendStateObj(e[n],"object"==_typeof(t[n])&&null!==t[n]?t[n]:{},a-1):e[n];return t}}]),i}(),N=function(){_inherits(i,React.PureComponent);var e=_createSuper(i);function i(){return _classCallCheck(this,i),e.apply(this,arguments)}return _createClass(i,[{key:"setNestedState",value:function(e,t){var a,n={};for(a in e)n[a]="object"==_typeof(e[a])&&null!==e[a]&&e[a]!=this.state[a]?this.__extendStateObj(e[a],"object"==_typeof(this.state[a])&&null!==this.state[a]?this.state[a]:{},t||10):e[a];return _get(_getPrototypeOf(i.prototype),"setState",this).call(this,n)}},{key:"__extendStateObj",value:function(e,t,a){for(var n in e)t[n]="object"==_typeof(e[n])&&null!==e[n]&&0<a?this.__extendStateObj(e[n],"object"==_typeof(t[n])&&null!==t[n]?t[n]:{},a-1):e[n];return t}}]),i}(),T=function(){_inherits(i,k);var n=_createSuper(i);function i(e){_classCallCheck(this,i);var t=n.call(this,e),a=(new Date).getFullYear(),e=Math.max.apply(Math,_toConsumableArray(e.years.filter(function(e){return e-a<=0})));return t.state={spreadsheetData:null,loadedYears:{},selectedYear:e,loading:!0,compactMode:"true"==s["applicants-compact_mode"],unbiasedMode:"true"==s["applicants-unbiased_mode"],detailOption:s["applicants-details"]||"Icons",autoSharePollResults:"false"!=s["applicants-auto_share_poll_results"],searchQuery:"",isFocusing:!1,applicantFocus:null,showSettings:!1,error:null,pollUnsubscribe:null,selectingApplicants:!1,selectedApplicants:[],selectionDisabled:!1,pollApplicants:[],pollCreationStep:0,pollSubmitted:!1,rankingApplicants:!1,rankedApplicants:[],pollType:null,previousPollData:null,eliminatingApplicants:!1,floatingRow:{active:!1,props:null,ref:React.createRef(),ID:null,coords:null,initCoords:null,touchID:null},filteredRowIndices:[],filteredRowMatchData:[],sharingPollResults:!1},document.addEventListener("click",function(){this.toggleSettingVisibility(!1)}.bind(_assertThisInitialized(t))),t.handler_rankingPointerup=t.handler_rankingPointerup.bind(_assertThisInitialized(t)),t.handler_rankingMousemove=t.handler_rankingMousemove.bind(_assertThisInitialized(t)),t.handler_rankingTouchend=t.handler_rankingTouchend.bind(_assertThisInitialized(t)),t.handler_rankingTouchmove=t.handler_rankingTouchmove.bind(_assertThisInitialized(t)),t.setAppState=t.setState.bind(_assertThisInitialized(t)),t.changeSearchQuery=t.changeSearchQuery.bind(_assertThisInitialized(t)),t.changeYearTo=t.changeYearTo.bind(_assertThisInitialized(t)),t.toggleSettingVisibility=t.toggleSettingVisibility.bind(_assertThisInitialized(t)),t.toggleVotingMode=t.toggleVotingMode.bind(_assertThisInitialized(t)),t.toggleUnbiasedMode=t.toggleUnbiasedMode.bind(_assertThisInitialized(t)),t.changeDetailOption=t.changeDetailOption.bind(_assertThisInitialized(t)),t.toggleApplicantSelection=t.toggleApplicantSelection.bind(_assertThisInitialized(t)),t.selectApplicant=t.selectApplicant.bind(_assertThisInitialized(t)),t.focusOnApplicant=t.focusOnApplicant.bind(_assertThisInitialized(t)),t.subscribeToPollResponses=t.subscribeToPollResponses.bind(_assertThisInitialized(t)),t.unsubscribeFromPollResponses=t.unsubscribeFromPollResponses.bind(_assertThisInitialized(t)),t.submitPollResponses=t.submitPollResponses.bind(_assertThisInitialized(t)),t.toggleRankingDrag=t.toggleRankingDrag.bind(_assertThisInitialized(t)),t.moveRankingRow=t.moveRankingRow.bind(_assertThisInitialized(t)),t.unfocusApplicant=t.unfocusApplicant.bind(_assertThisInitialized(t)),t.reloadSearchResults=t.reloadSearchResults.bind(_assertThisInitialized(t)),t.toggleAutoSharePollResults=t.toggleAutoSharePollResults.bind(_assertThisInitialized(t)),t.beginEliminatingApplicants=t.beginEliminatingApplicants.bind(_assertThisInitialized(t)),t.finishEliminatingApplicants=t.finishEliminatingApplicants.bind(_assertThisInitialized(t)),t.cancelEliminatingApplicants=t.cancelEliminatingApplicants.bind(_assertThisInitialized(t)),t}return _createClass(i,[{key:"componentDidMount",value:function(){this.changeYearTo(this.state.selectedYear,function(){c.includes("applicant_voter")&&d.onSnapshot(function(e){var t=e.data();t.active&&!z.active?(e=Y.onSnapshot(function(e){e=e.data();if(!(user.uid in e&&z.poll)&&(!this.state.previousPollResults&&e.poll_results?this.setState({previousPollResults:JSON.parse(e.poll_results)}):e.poll_results||this.setState({previousPollResults:null}),!e.poll_data||user.uid in e||Y.update(_defineProperty({},user.uid,[user.profile.name,!1,null])),z.poll=e.poll_data,z.master[0]==user.uid&&0==this.state.pollCreationStep&&(e.poll_data&&this.subscribeToPollResponses(),e.poll_results&&this.setState({pollCreationStep:6,sharingPollResults:!0})),this.onReceivePoll(),user.uid in e&&e[user.uid][1]))if(this.state.selectingApplicants)this.setState({pollSubmitted:!0,selectedApplicants:e[user.uid][2].split("|")});else if(this.state.rankingApplicants){for(var t=z.poll[1].split("|"),a=e[user.uid][2].split("|"),n=new Array(t.length).fill().map(function(e,t){return t}),i=0,s=a.length;i<s;i++){for(var l=t.indexOf(a[i]),o=n.indexOf(l,l);i<o;o--)n[o]=n[o-1];n[i]=l}this.setState({pollSubmitted:!0,rankedApplicants:n})}}.bind(this)),this.setState({pollUnsubscribe:e})):!t.active&&z.active&&"function"==typeof this.state.pollUnsubscribe&&this.state.pollUnsubscribe(),z=_objectSpread(_objectSpread({},t),{},{poll_receivers:[]}),this.onReceiveVotingData()}.bind(this))}.bind(this))}},{key:"render",value:function(){var e,t,a,n;if(this.state.applicantFocus&&(t=(e=_slicedToArray(this.state.applicantFocus.split("-"),2))[0],e=e[1],t=+t+2e3,a=parseInt(e,16)),this.state.applicantFocus)for(var i=this.state.spreadsheetData,s=i.rows.length-1;0<=s;s--)parseInt(i.rows[s][i.c_ID],16)==a&&(n=s);return React.createElement(React.Fragment,null,React.createElement(w,{searchQuery:this.state.searchQuery,selectedYear:this.state.selectedYear,years:this.props.years,unbiasedMode:this.state.unbiasedMode,detailOption:this.state.detailOption,autoSharePollResults:this.state.autoSharePollResults,showSettings:this.state.showSettings,setAppState:this.setAppState,changeSearchQuery:this.changeSearchQuery,changeYearTo:this.changeYearTo,toggleSettingVisibility:this.toggleSettingVisibility,toggleVotingMode:this.toggleVotingMode,toggleUnbiasedMode:this.toggleUnbiasedMode,toggleAutoSharePollResults:this.toggleAutoSharePollResults,changeDetailOption:this.changeDetailOption}),React.createElement(O,{selectedApplicants:this.state.selectedApplicants,pollCreationStep:this.state.pollCreationStep,pollSubmitted:this.state.pollSubmitted,pollType:this.state.pollType,pollApplicants:this.state.pollApplicants,previousPollData:this.state.previousPollData,previousPollResults:this.state.previousPollResults,sharingPollResults:this.state.sharingPollResults,autoSharePollResults:this.state.autoSharePollResults,eliminatingApplicants:this.state.eliminatingApplicants,setAppState:this.setAppState,subscribeToPollResponses:this.subscribeToPollResponses,unsubscribeFromPollResponses:this.unsubscribeFromPollResponses,toggleApplicantSelection:this.toggleApplicantSelection,reloadSearchResults:this.reloadSearchResults,beginEliminatingApplicants:this.beginEliminatingApplicants,cancelEliminatingApplicants:this.cancelEliminatingApplicants,finishEliminatingApplicants:this.finishEliminatingApplicants}),React.createElement(P,{year:this.state.selectedYear,spreadsheetData:this.state.spreadsheetData,loading:this.state.loading,error:this.state.error,compactMode:this.state.compactMode,unbiasedMode:this.state.unbiasedMode,detailOption:this.state.detailOption,selectingApplicants:this.state.selectingApplicants,selectedApplicants:this.state.selectedApplicants,selectionDisabled:this.state.selectionDisabled,rankingApplicants:this.state.rankingApplicants,rankedApplicants:this.state.rankedApplicants,pollApplicants:this.state.pollApplicants,pollSubmitted:this.state.pollSubmitted,floatingRow:this.state.floatingRow,filteredRowIndices:this.state.filteredRowIndices,filteredRowMatchData:this.state.filteredRowMatchData,previousPollResults:this.state.previousPollResults,setAppState:this.setAppState,toggleApplicantSelection:this.toggleApplicantSelection,selectApplicant:this.selectApplicant,focusOnApplicant:this.focusOnApplicant,submitPollResponses:this.submitPollResponses,toggleRankingDrag:this.toggleRankingDrag,moveRankingRow:this.moveRankingRow}),React.createElement(M,{spreadsheetData:this.state.spreadsheetData,active:this.state.isFocusing,applicant:this.state.applicantFocus,year:t,id:a,applicantRowIndex:n,unbiasedMode:this.state.unbiasedMode,unfocusApplicant:this.unfocusApplicant,setAppState:this.setAppState}))}},{key:"reloadSearchResults",value:function(){this.changeSearchQuery(this.state.searchQuery)}},{key:"changeSearchQuery",value:function(e){var t="string"==typeof e?e:e.currentTarget.value,a=this.parseSearchQuery(t),e=_slicedToArray(this.filterApplicantRows(a),2),a=e[0],e=e[1];this.setState({searchQuery:t,filteredRowIndices:a,filteredRowMatchData:e})}},{key:"parseSearchQuery",value:function(e){var t={id:null,status:null,words:null},a=e=e.toLowerCase().trim();"s"==e[e.length-1]&&(a=e.substring(0,e.length-1));var n=(e=~l.indexOf(a)?"status:"+a:e).match(o);n&&(e=e.substring(0,n.index)+e.substring(n.index+n[0].length),t.status=l.filter(function(e){return 0==e.indexOf(n[1])}));var i,s,a=e.match(r);return a&&(e=e.substring(0,a.index)+e.substring(a.index+a[0].length),"string"==typeof a[4]?(i=this.state.selectedYear,s=parseInt(a[4],16)):"string"==typeof a[3]?(i=this.state.selectedYear,s=parseInt(a[3],16)):"string"==typeof a[1]&&"string"==typeof a[2]&&(i=+a[1],s=parseInt(a[2],16)),i<2e3&&(i+=2e3),isNaN(s)||(t.id=s),this.state.selectedYear!=i&&this.changeYearTo(i)),(e=e.trim()).length&&(e=e.split(/\s+/).filter(function(e){return 1<e.length}).sort(function(e,t){return t.length-e.length}),t.words=e),t}},{key:"filterApplicantRows",value:function(e){var t,a=[],n=[],i=this.state.rankingApplicants||this.state.selectingApplicants,s=this.state.spreadsheetData,l=null;z.active&&(l=z.applicants.slice(),z.poll&&(t=z.poll[1].split("|"),l=l.filter(function(e){return~t.indexOf(e)})),l.sort(function(e,t){return parseInt(t,16)-parseInt(e,16)}));for(var o=this.state.unbiasedMode?["College","Location"]:["First","Last","Email","College","Location"],r=0,c=s.rows.length;r<c;r++){var p=s.rows[r],u={};if(l){if(l[l.length-1]!=p[s.c_ID])continue;l.pop()}if(null!==e.id)if(parseInt(p[s.c_ID],16)==e.id)u.ID=!0;else{if(!i)continue;u.ID=!1}if(null!==e.status){var d=(_defineProperty(d={},ee.Enum.STATUS.APPLICANT,"applicant"),_defineProperty(d,ee.Enum.STATUS.SECOND_READ,"2nd read"),_defineProperty(d,ee.Enum.STATUS.FINALIST,"finalist"),_defineProperty(d,ee.Enum.STATUS.RECIPIENT,"recipient"),_defineProperty(d,ee.Enum.STATUS.INELIGIBLE,"ineligible"),d[p[s.c_Status]]);if(~e.status.indexOf(d))u.Status=!0;else{if(!i)continue;u.Status=!1}}if(null!==e.words){var h,m={},g=_createForOfIteratorHelper(o);try{for(g.s();!(h=g.n()).done;){var f=h.value,E=void 0;try{if((E=p[s.c(f)])==te)continue}catch(e){continue}E=ne[f](E).toLowerCase(),m[f]=E,u[f]=[]}}catch(e){g.e(e)}finally{g.f()}var v,R=!0,_=_createForOfIteratorHelper(e.words);try{for(_.s();!(v=_.n()).done;){var y,b=v.value,A=!1;for(y in m)for(var S,k=m[y],N=0;~(S=k.indexOf(b,N));){for(var T=!1,w=0,I=u[y].length;w<I;w++)if(S<=u[y][w][1]){if(T=!0,S+b.length<u[y][w][0])u[y].splice(w,0,[S,S+b.length]);else{u[y][w][0]=Math.min(S,u[y][w][0]),u[y][w][1]=Math.max(S+b.length,u[y][w][1]);for(var P=0;w+1+P<u[y].length&&u[y][w+1+P][0]<=S+b.length;)u[y][w][1]=Math.max(S+b.length,u[y][w+1+P][1]),P++;for(var C=w+1,O=u[y].length-P;C<O;C++)u[y][C]=u[y][C+P];u[y].length-=P}break}T||u[y].push([S,S+b.length]),N=S+1,A=!0}if(!A&&(R=!1,!i))break}}catch(e){_.e(e)}finally{_.f()}if(!R&&!i)continue}a.push(r),n.push(u)}return[a,n]}},{key:"changeYearTo",value:function(h,t,a){function e(e){this.setState({spreadsheetData:e,filteredRowIndices:[],filteredRowMatchData:[],error:null,loading:!1},this.reloadSearchResults),t(e)}function n(e){"PERMISSION_DENIED"==e.result.error.status?this.setState({error:React.createElement(React.Fragment,null,"Your account does not have viewing permission for this year's Google Sheet. Try viewing the spreadsheet using the button below, and request permission.",React.createElement("a",{href:"https://docs.google.com/spreadsheets/d/".concat(ee[h].id,"/view"),id:"open_spreadsheet",className:"button",target:"_blank"},"View Spreadsheet")),loading:!1}):(this.setState({error:"There was an unknown problem getting this year's applicant data.",loading:!1}),a(e))}h in ee&&(t="function"==typeof t?t:function(){},a="function"==typeof a?a:function(){},this.setState({selectedYear:+h,loading:!0}),h in this.state.loadedYears?this.state.loadedYears[h].loaded?e.call(this,this.state.loadedYears[h].data):n.call(this,this.state.loadedYears[h].error):new Promise(function(d,t){gapiLoaded.then(function(){return gapi.client.sheets.spreadsheets.values.get({spreadsheetId:ee[h].id,range:ee[h].sheet}).then(function(e){var t=e.result.values,n=t.shift();function a(e){var t=e in ee[h].mapping?ee[h].mapping[e]:e,a=n.indexOf(t);if(t!=m&&~a)return a;throw new RangeError('No column with name "'.concat(e,'".'))}for(var i=t.length-1;0<=i;i--){var s=n.length-t[i].length;s&&(t[i]=t[i].concat(new Array(s).fill("")))}var l,o=ee[h].translate.from;for(l in o){var r,c=a(l),p=_createForOfIteratorHelper(t);try{for(p.s();!(r=p.n()).done;){var u=r.value;u[c]=o[l](u[c].trim())}}catch(e){p.e(e)}finally{p.f()}}e={c:a,c_ID:a("ID"),c_First:a("First"),c_Last:a("Last"),c_Status:a("Status"),headers:n,rows:t};this.state.loadedYears[h]={loaded:!0,data:e},d(e)}.bind(this),function(e){this.state.loadedYears[h]={loaded:!1,error:e},t(e)}.bind(this))}.bind(this))}.bind(this)).then(e.bind(this),n.bind(this)))}},{key:"focusOnApplicant",value:function(e){var t=+e.split("-")[0]+2e3;isNaN(t)||this.changeYearTo(t,function(){this.setState({isFocusing:!0,applicantFocus:e})}.bind(this))}},{key:"unfocusApplicant",value:function(){this.setState({isFocusing:!1,applicantFocus:null})}},{key:"toggleSettingVisibility",value:function(e){this.state.showSettings!=e&&this.setState({showSettings:e})}},{key:"toggleVotingMode",value:function(e){var t=null;if(e){var a,n=this.state.spreadsheetData,t=[],i=_createForOfIteratorHelper(n.rows);try{for(i.s();!(a=i.n()).done;){var s=a.value;s[n.c_Status]!=ee.Enum.STATUS.FINALIST&&s[n.c_Status]!=ee.Enum.STATUS.RECIPIENT||t.push(s[n.c_ID])}}catch(e){i.e(e)}finally{i.f()}this.setState({pollCreationStep:0})}Y.set({poll_data:null}),d.update({active:e,year:e?this.state.selectedYear:null,master:e?[user.uid,user.profile.name]:null,applicants:t,eliminated:[]})}},{key:"toggleAutoSharePollResults",value:function(e){var t=new Date;t.setFullYear(t.getFullYear()+10),document.cookie="applicants-auto_share_poll_results=".concat(e,";expires=").concat(t.toUTCString()),s["applicants-auto)share_poll_results"]="".concat(e),this.setState({autoSharePollResults:e})}},{key:"onReceiveVotingData",value:function(){z.active&&this.state.selectedYear!=z.year&&this.changeYearTo(z.year),this.setState({unbiasedMode:z.active||"true"==s["applicants-unbiased_mode"]},this.reloadSearchResults)}},{key:"onReceivePoll",value:function(){z.poll?("selection"==z.poll[0]?this.state.selectingApplicants||this.toggleApplicantSelection(!0):this.state.rankingApplicants||this.toggleApplicantRanking(!0),this.setState({pollApplicants:z.poll[1].split("|"),pollType:z.poll[0],pollSubmitted:!1,previousPollData:[z.poll[0],z.poll[1].split("|"),z.poll[2]]}),this.reloadSearchResults()):(this.state.selectingApplicants&&this.toggleApplicantSelection(!1),this.state.rankingApplicants&&this.toggleApplicantRanking(!1),this.setState({pollApplicants:[],pollType:null,pollSubmitted:!1},this.reloadSearchResults))}},{key:"toggleUnbiasedMode",value:function(e){var t=new Date;t.setFullYear(t.getFullYear()+10),document.cookie="applicants-unbiased_mode=".concat(e,";expires=").concat(t.toUTCString()),s["applicants-unbiased_mode"]="".concat(e),this.setState({unbiasedMode:e},function(){this.changeSearchQuery(this.state.searchQuery)}.bind(this))}},{key:"changeDetailOption",value:function(e){var t=new Date;t.setFullYear(t.getFullYear()+10),document.cookie="applicants-details=".concat(e,";expires=").concat(t.toUTCString()),s["applicants-details"]="".concat(e),this.setState({detailOption:e})}},{key:"toggleApplicantSelection",value:function(e){this.setState({selectingApplicants:e,selectedApplicants:e?this.state.selectedApplicants:[],selectionDisabled:!!e&&this.state.selectionDisabled,rankingApplicants:!e&&this.state.rankingApplicants})}},{key:"toggleApplicantRanking",value:function(e){this.setState({rankingApplicants:e,rankedApplicants:e?this.state.rankedApplicants.length?this.state.rankedApplicants:new Array(z.poll[1].split("|").length).fill(0).map(function(e,t){return t}):[],selectingApplicants:!e&&this.state.selectingApplicants})}},{key:"selectApplicant",value:function(e){e.stopPropagation();var t=e.currentTarget.parentNode.getAttribute("data-applicant-id").split("-")[1],e=this.state.selectedApplicants.indexOf(t);if(~e)this.state.selectedApplicants.splice(e,1),this.setState({selectionDisabled:!1});else{if(z.poll&&this.state.selectedApplicants.length>=z.poll[2])return;this.state.selectedApplicants.push(t),this.setState({selectionDisabled:z.poll&&this.state.selectedApplicants.length>=z.poll[2]})}this.forceUpdate()}},{key:"subscribeToPollResponses",value:function(){this.unsubscribeFromPollResponses();var e=Y.onSnapshot(function(e){var t,a=e.data(),n=[];for(t in z.poll_responses=a)"poll_data"!=t&&t!=user.uid&&n.push([t].concat(_toConsumableArray(a[t])));z.poll_receivers=n,this.forceUpdate()}.bind(this));this.setState({pollCreationStep:5,receiverUnsubscribe:e})}},{key:"unsubscribeFromPollResponses",value:function(){"function"==typeof this.state.receiverUnsubscribe&&(this.state.receiverUnsubscribe(),this.setState({receiverUnsubscribe:null}))}},{key:"submitPollResponses",value:function(){var t=this;"selection"==z.poll[0]?Y.update(_defineProperty({},user.uid,[user.profile.name,!0,this.state.selectedApplicants.join("|")])):Y.update(_defineProperty({},user.uid,[user.profile.name,!0,this.state.rankedApplicants.slice(0,z.poll[2]).map(function(e){return t.state.pollApplicants[e]}).join("|")])),this.setState({pollSubmitted:!0})}},{key:"toggleRankingDrag",value:function(e,t,a,n,i,s,l,o){e?(document.addEventListener("mouseup",this.handler_rankingPointerup),document.addEventListener("mousemove",this.handler_rankingMousemove),document.addEventListener("touchend",this.handler_rankingTouchend),document.addEventListener("touchcancel",this.handler_rankingTouchend),document.addEventListener("touchmove",this.handler_rankingTouchmove,{passive:!1}),document.documentElement.setAttribute("data-is-dragging","true"),this.setNestedState({floatingRow:{ID:a,props:t,active:!0,coords:n,initCoords:i,rowIndex:s,origElement:l,rankingIndex:this.state.rankedApplicants.indexOf(s),touchID:o}},2)):(document.removeEventListener("mouseup",this.handler_rankingPointerup),document.removeEventListener("mousemove",this.handler_rankingMousemove),document.removeEventListener("touchend",this.handler_rankingTouchend),document.removeEventListener("touchcancel",this.handler_rankingTouchend),document.removeEventListener("touchmove",this.handler_rankingTouchmove,{passive:!1}),document.documentElement.setAttribute("data-is-dragging","false"),this.setNestedState({floatingRow:{ID:null,props:null,active:!1,coords:null,initCoords:null,rowIndex:null,origElement:null,rankingIndex:null,mouseMoveTimeout:null,mouseMoveYPos:null,touchID:o}}))}},{key:"handler_rankingPointerup",value:function(){this.state.floatingRow.mouseMoveTimeout&&(clearTimeout(this.state.floatingRow.mouseMoveTimeout),this.handleFloatingRowMoveTimeout()),this.toggleRankingDrag(!1)}},{key:"handler_rankingTouchend",value:function(e){var t,a=!1,n=_createForOfIteratorHelper(e.changedTouches);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.identifier==this.state.floatingRow.touchID){a=i;break}}}catch(e){n.e(e)}finally{n.f()}a&&this.handler_rankingPointerup()}},{key:"handler_rankingMousemove",value:function(e){this.handleFloatingRowMove(e.pageX,e.pageY)}},{key:"handler_rankingTouchmove",value:function(e){var t,a=!1,n=_createForOfIteratorHelper(e.changedTouches);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.identifier==this.state.floatingRow.touchID){a=i;break}}}catch(e){n.e(e)}finally{n.f()}a&&(e.preventDefault(),this.handleFloatingRowMove(a.pageX,a.pageY))}},{key:"handleFloatingRowMove",value:function(e,t){this.state.floatingRow.ref.current.style.left="".concat(e-this.state.floatingRow.coords[0],"px"),this.state.floatingRow.ref.current.style.top="".concat(t-this.state.floatingRow.coords[1],"px"),this.state.floatingRow.mouseMoveYPos=t,this.state.floatingRow.mouseMoveTimeout||(this.state.floatingRow.mouseMoveTimeout=setTimeout(this.handleFloatingRowMoveTimeout.bind(this),0))}},{key:"handleFloatingRowMoveTimeout",value:function(){if(null!==this.state.floatingRow.mouseMoveYPos){this.state.floatingRow.mouseMoveTimeout=null;var e=this.state.floatingRow.mouseMoveYPos;this.state.floatingRow.mouseMoveYPos=null;var t=this.state.floatingRow.origElement.offsetHeight,e=e-this.state.floatingRow.coords[1]-this.state.floatingRow.initCoords[1],a=Math.round(e/t),n=this.state.floatingRow.rankingIndex,e=n+a;if(e<0&&(a=-n,e=0),e>=this.state.filteredRowIndices.length&&(a=this.state.filteredRowIndices.length-1-n,e=this.state.filteredRowIndices.length-1),0!=a&&!(e<0||e>=this.state.filteredRowIndices.length)){if(this.state.floatingRow.rankingIndex=e,0<a)for(var i=0;i<a;i++)this.state.rankedApplicants[n+i]=this.state.rankedApplicants[n+i+1];else for(var s=0;s<-a;s++)this.state.rankedApplicants[n-s]=this.state.rankedApplicants[n-s-1];this.state.floatingRow.props.rank=e<z.poll[2]?e+1:"—",this.state.rankedApplicants[e]=this.state.floatingRow.rowIndex,this.state.floatingRow.initCoords[1]+=t*a,this.forceUpdate()}}}},{key:"moveRankingRow",value:function(e,t){var a=this.state.rankedApplicants.indexOf(t);"UP"==e&&0<a?(t=[this.state.rankedApplicants[a-1],this.state.rankedApplicants[a]],this.state.rankedApplicants[a]=t[0],this.state.rankedApplicants[a-1]=t[1]):"DOWN"==e&&a<this.state.rankedApplicants.length-1&&(e=[this.state.rankedApplicants[a+1],this.state.rankedApplicants[a]],this.state.rankedApplicants[a]=e[0],this.state.rankedApplicants[a+1]=e[1]),this.forceUpdate()}},{key:"beginEliminatingApplicants",value:function(){this.setState({eliminatingApplicants:!0}),this.toggleApplicantSelection(!0)}},{key:"finishEliminatingApplicants",value:function(){var e,t=z.applicants,a=z.eliminated,n=_createForOfIteratorHelper(this.state.selectedApplicants);try{for(n.s();!(e=n.n()).done;){var i=e.value,s=t.indexOf(i);~s&&a.push.apply(a,_toConsumableArray(t.splice(s,1)))}}catch(e){n.e(e)}finally{n.f()}d.update({applicants:t,eliminated:a}),this.cancelEliminatingApplicants()}},{key:"cancelEliminatingApplicants",value:function(){this.setState({eliminatingApplicants:!1}),this.toggleApplicantSelection(!1)}}]),i}(),w=function(){_inherits(i,N);var n=_createSuper(i);function i(e){var t;_classCallCheck(this,i);for(var a=e.years.length-1;0<=a;a--)e.years[a]=React.createElement("option",{key:e.years[a]},e.years[a]);return(t=n.call(this,e)).changeYear=t.changeYear.bind(_assertThisInitialized(t)),t}return _createClass(i,[{key:"render",value:function(){return React.createElement("div",{id:"search_bar"},React.createElement("input",{value:this.props.searchQuery,placeholder:"Search Applicants",onChange:this.props.changeSearchQuery}),React.createElement("select",{value:this.props.selectedYear,onChange:this.changeYear,disabled:z.active},this.props.years),React.createElement(I,{shown:this.props.showSettings,unbiasedMode:this.props.unbiasedMode,detailOption:this.props.detailOption,autoSharePollResults:this.props.autoSharePollResults,toggleSettingVisibility:this.props.toggleSettingVisibility,toggleVotingMode:this.props.toggleVotingMode,toggleUnbiasedMode:this.props.toggleUnbiasedMode,toggleAutoSharePollResults:this.props.toggleAutoSharePollResults,changeDetailOption:this.props.changeDetailOption}))}},{key:"changeYear",value:function(e){this.props.changeYearTo(e.currentTarget.value)}}]),i}(),I=function(){_inherits(a,N);var t=_createSuper(a);function a(e){return _classCallCheck(this,a),(e=t.call(this,e)).toggleSettingVisibility=e.toggleSettingVisibility.bind(_assertThisInitialized(e)),e.toggleVotingMode=e.toggleVotingMode.bind(_assertThisInitialized(e)),e.toggleUnbiasedMode=e.toggleUnbiasedMode.bind(_assertThisInitialized(e)),e.changeDetailOption=e.changeDetailOption.bind(_assertThisInitialized(e)),e.toggleAutoSharePollResults=e.toggleAutoSharePollResults.bind(_assertThisInitialized(e)),e}return _createClass(a,[{key:"render",value:function(){return React.createElement("div",{id:"options",onClick:function(e){return e.stopPropagation()}},React.createElement("input",{type:"checkbox",checked:this.props.shown,onChange:this.toggleSettingVisibility}),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor"},React.createElement("path",{d:"M496.647,312.107l-47.061-36.8c1.459-12.844,1.459-25.812,0-38.656l47.104-36.821c8.827-7.109,11.186-19.575,5.568-29.419l-48.96-84.629c-5.639-9.906-17.649-14.232-28.309-10.197l-55.467,22.315c-10.423-7.562-21.588-14.045-33.323-19.349l-8.512-58.923c-1.535-11.312-11.24-19.72-22.656-19.627h-98.133c-11.321-0.068-20.948,8.246-22.528,19.456l-8.533,59.093c-11.699,5.355-22.846,11.843-33.28,19.371L86.94,75.563c-10.55-4.159-22.549,0.115-28.096,10.005L9.841,170.347c-5.769,9.86-3.394,22.463,5.568,29.547l47.061,36.8c-1.473,12.843-1.473,25.813,0,38.656l-47.104,36.8c-8.842,7.099-11.212,19.572-5.589,29.419l48.939,84.651c5.632,9.913,17.649,14.242,28.309,10.197l55.467-22.315c10.432,7.566,21.604,14.056,33.344,19.371l8.533,58.88c1.502,11.282,11.147,19.694,22.528,19.648h98.133c11.342,0.091,21-8.226,22.592-19.456l8.533-59.093c11.698-5.357,22.844-11.845,33.28-19.371l55.68,22.379c10.55,4.149,22.543-0.122,28.096-10.005l49.152-85.12C507.866,331.505,505.447,319.139,496.647,312.107z M255.964,362.667c-58.91,0-106.667-47.756-106.667-106.667s47.756-106.667,106.667-106.667s106.667,47.756,106.667,106.667C362.56,314.882,314.845,362.597,255.964,362.667z"})),React.createElement("div",{id:"options_window"},p?React.createElement(React.Fragment,null,React.createElement("div",{className:"option_row"},React.createElement("span",{className:"option_name"},"Voting Mode"),React.createElement("span",{className:"spacer"}),React.createElement("span",{className:"option_value"},React.createElement("input",{type:"checkbox",className:"toggler",checked:z.active,disabled:z.active&&z.master[0]!==user.uid,onChange:this.toggleVotingMode}),React.createElement("span",null))),React.createElement("div",{className:"option_desc"},"Lets you send out voting polls to other voters."),z.active&&z.master[0]!=user.uid?React.createElement("div",{className:"option_desc option_alert"},"Voting Mode must be disabled by ",z.master[1],"."):null):null,z.active&&z.master[0]==user.uid?React.createElement(React.Fragment,null,React.createElement("div",{className:"option_row"},React.createElement("span",{className:"option_name"},"Auto-Share Poll Results"),React.createElement("span",{className:"spacer"}),React.createElement("span",{className:"option_value"},React.createElement("input",{type:"checkbox",className:"toggler",checked:this.props.autoSharePollResults,onChange:this.toggleAutoSharePollResults}),React.createElement("span",null))),React.createElement("div",{className:"option_desc"},"Automatically shares poll results with other voters.")):null,React.createElement("div",{className:"option_row"},React.createElement("span",{className:"option_name"},"Unbiased Mode"),React.createElement("span",{className:"spacer"}),React.createElement("span",{className:"option_value"},React.createElement("input",{type:"checkbox",className:"toggler",checked:this.props.unbiasedMode,disabled:z.active,onChange:this.toggleUnbiasedMode}),React.createElement("span",null))),React.createElement("div",{className:"option_desc"},"Hides personally identifying information to prevent bias."),z.active?React.createElement("div",{className:"option_desc option_alert"},"Unbiased Mode cannot be turned off while voting."):null,React.createElement("div",{className:"option_row"},React.createElement("span",{className:"option_name"},"Details"),React.createElement("span",{className:"spacer"}),React.createElement("span",{className:"option_value"},React.createElement("select",{value:this.props.detailOption,onChange:this.changeDetailOption},React.createElement("option",null,"Icons"),React.createElement("option",null,"#ID"),React.createElement("option",null,"None")))),React.createElement("div",{className:"option_desc"},"Which details to show on the right-hand side of each applicant.")))}},{key:"toggleSettingVisibility",value:function(e){this.props.toggleSettingVisibility(e.currentTarget.checked)}},{key:"toggleVotingMode",value:function(e){this.props.toggleVotingMode(e.currentTarget.checked)}},{key:"toggleAutoSharePollResults",value:function(e){this.props.toggleAutoSharePollResults(e.currentTarget.checked)}},{key:"toggleUnbiasedMode",value:function(e){this.props.toggleUnbiasedMode(e.currentTarget.checked)}},{key:"changeDetailOption",value:function(e){this.props.changeDetailOption(e.currentTarget.value)}}]),a}(),P=function(){_inherits(a,k);var t=_createSuper(a);function a(e){return _classCallCheck(this,a),t.call(this,e)}return _createClass(a,[{key:"render",value:function(){var t=this,e=React.createElement("div",{id:"applicant_status_legend"},React.createElement("div",null,React.createElement("div",null,React.createElement("div",{className:"applicant_status applicant_status_applicant"},"A"),React.createElement("span",null,"Applicant")),React.createElement("div",null,React.createElement("div",{className:"applicant_status applicant_status_2nd_read"},"2"),React.createElement("span",null,"2nd Read")),React.createElement("div",null,React.createElement("div",{className:"applicant_status applicant_status_finalist"},"F"),React.createElement("span",null,"Finalist")),React.createElement("div",null,React.createElement("div",{className:"applicant_status applicant_status_recipient"},"R"),React.createElement("span",null,"Recipient")),React.createElement("div",null,React.createElement("div",{className:"applicant_status applicant_status_ineligible"},"I"),React.createElement("span",null,"Ineligible")))),a=[];if(z.active&&user.uid!=z.master[0]?a.push(React.createElement("p",{key:"voting mode"},"Voting Mode was turned on by ",z.master[1],". Personally identifying information is hidden and only finalists from this year are being shown.")):this.props.unbiasedMode&&a.push(React.createElement("p",{key:"unbiased mode"},"Unbiased Mode is enabled. Names and other personally identifying information have been hidden.")),z.poll&&a.push(React.createElement(React.Fragment,{key:"poll submit"},React.createElement("p",null,this.props.pollSubmitted?"Thank you for submitting your response. You can change your answers (and Resubmit when you're done) until the poll is closed.":"selection"==z.poll[0]?"Please select the top ".concat(1==z.poll[2]?"applicant":"".concat(z.poll[2]," applicants")," from the list below and click Submit when you're done. Click the squares on the left of each applicant to select and unselect them."):"Please rank the top ".concat(1==z.poll[2]?"applicant":"".concat(z.poll[2]," applicants")," from the list below and click Submit when you're done. Drag the applicants in the order you want (or use the arrows when you hover over them).")),React.createElement("button",{disabled:!this.props.rankingApplicants&&this.props.selectedApplicants.length!=z.poll[2],className:"poll_ready",onClick:this.props.submitPollResponses},this.props.pollSubmitted?"Resubmit":"Submit"))),this.props.previousPollResults&&z.master[0]!=user.uid&&a.push(React.createElement(React.Fragment,{key:"poll results"},React.createElement("p",null,z.master[1]," is sharing the results of the previous poll:"),React.createElement("div",{className:"poll_res"},React.createElement("div",{className:"poll_res_container"},this.props.previousPollResults.map(function(e){return React.createElement("div",{key:e[0],className:"poll_res_col"},React.createElement("div",{className:"poll_res_bar"},React.createElement("div",{style:{flexGrow:1-e[1]}},React.createElement("span",{className:.5<=e[1]?"hidden":""},e[2])),React.createElement("div",{style:{flexGrow:e[1]}},React.createElement("span",{className:.5<=e[1]?"":"hidden"},e[2]))),React.createElement("div",{className:"poll_res_name"},"#",e[0]))}))))),this.props.loading)return React.createElement(React.Fragment,null,React.createElement("div",{id:"pre_applicant_message",className:a.length?"":"hidden"},a),React.createElement("div",{id:"applicant_table",className:this.props.compactMode?"compact":""},React.createElement("div",{id:"applicant_message"},"Loading Applicant Data...")),e);if(null!==this.props.error)return React.createElement(React.Fragment,null,React.createElement("div",{id:"pre_applicant_message",className:a.length?"":"hidden"},a),React.createElement("div",{id:"applicant_table",className:this.props.compactMode?"compact":""},React.createElement("div",{id:"applicant_error"},this.props.error)),e);for(var n=this.props.spreadsheetData,i=this.props.rankingApplicants?z.poll[1].split("|"):null,s=new Array(n.rows.length),l=[],o=0,r=n.rows.length;o<r;o++){var c,p=n.rows[o],u=this.props.filteredRowIndices.indexOf(o),d=this.props.filteredRowMatchData[u]||{},h="";this.props.rankingApplicants&&(c=void 0,~(c=i.indexOf(n.rows[o][n.c_ID]))&&(h=(h=this.props.rankedApplicants.indexOf(l.length)+1)>z.poll[2]?"—":h.toString(),i[c]=i[i.length-1],i.pop(),l.push(o))),s[o]={key:p[n.c_ID],year:this.props.year,row:p,data:n,filteredIndex:u,hidden:!~u,isFirstFiltered:!1,isLastFiltered:!1,unbiasedMode:this.props.unbiasedMode,detailOption:this.props.detailOption,selectable:this.props.selectingApplicants,selected:this.props.selectedApplicants.includes(p[n.c_ID]),selectionDisabled:this.props.selectionDisabled,rankable:this.props.rankingApplicants,rank:h,filteringByStatus:d.Status,filteringByID:d.ID,filteredBy:d,floatingRow:this.props.floatingRow}}if(l.length){for(var m=l.map(function(e){return s[e]}),g=0,f=l.length;g<f;g++){var E=this.props.rankedApplicants.indexOf(g);s[l[E]]=m[g]}s[l[0]].isFirstFiltered=!0,s[l[l.length-1]].isLastFiltered=!0}for(var v=0,R=this.props.filteredRowIndices.length;v<R;v++){var _=this.props.filteredRowIndices[v],y=s[_].row[n.c_Status];s[_].borderRadiusTop=0==v||y!=s[this.props.filteredRowIndices[v-1]].row[n.c_Status],s[_].borderRadiusBottom=R<=v+1||y!=s[this.props.filteredRowIndices[v+1]].row[n.c_Status]}var b=s.map(function(e){return React.createElement(C,_extends({},e,{selectApplicant:t.props.selectApplicant,focusOnApplicant:t.props.focusOnApplicant,toggleRankingDrag:t.props.toggleRankingDrag,moveRankingRow:t.props.moveRankingRow}))}),A=React.createElement(D,{floatingRow:this.props.floatingRow});return React.createElement(React.Fragment,null,React.createElement("div",{id:"pre_applicant_message",className:a.length?"":"hidden"},a),React.createElement("div",{id:"applicant_table",className:(this.props.compactMode?" compact":"")+(this.props.unbiasedMode?" unbiased":"")},z.active?z.applicants.length?null:React.createElement("div",{className:"num_results"},React.createElement("span",null,"All applicants have been eliminated.")):React.createElement("div",{className:"num_results"},React.createElement("span",null,"Showing ",React.createElement("span",{className:"applicant_num"},this.props.filteredRowIndices.length," ",this.props.filteredRowIndices.length==this.props.spreadsheetData.rows.length?"applicant":"result",1==this.props.filteredRowIndices.length?"":"s"))),b,A),e)}}]),a}(),C=function(){_inherits(a,k);var t=_createSuper(a);function a(e){return _classCallCheck(this,a),(e=t.call(this,e)).state={touchID:null,pointerDown:!1,pointerStartPos:null,pointerStartElement:null,pointerDownTimeout:null,isBeingDragged:!1},e.initRankingDrag=e.initRankingDrag.bind(_assertThisInitialized(e)),e.attemptFocusOnApplicant=e.attemptFocusOnApplicant.bind(_assertThisInitialized(e)),e.handler_rankingMousedown=e.handler_rankingMousedown.bind(_assertThisInitialized(e)),e.handler_rankingTouchstart=e.handler_rankingTouchstart.bind(_assertThisInitialized(e)),e}return _createClass(a,[{key:"render",value:function(){var e=this.props.row,t=this.props.data,a="".concat(this.props.year-2e3,"-").concat(e[t.c_ID]),n=(_defineProperty(R={},ee.Enum.STATUS.APPLICANT,"applicant"),_defineProperty(R,ee.Enum.STATUS.SECOND_READ,"2nd read"),_defineProperty(R,ee.Enum.STATUS.FINALIST,"finalist"),_defineProperty(R,ee.Enum.STATUS.RECIPIENT,"recipient"),_defineProperty(R,ee.Enum.STATUS.INELIGIBLE,"ineligible"),R[e[t.c_Status]]||"applicant"),i=this.props.selectable?React.createElement("div",{className:"applicant_selection"+(this.props.selectionDisabled?" disabled":""),onClick:this.props.selectApplicant}):this.props.rankable?React.createElement("div",{className:"applicant_ranking"},React.createElement("div",_extends({tabIndex:this.props.isFirstFiltered?null:"0"},_(this.moveRowUp.bind(this)),{className:this.props.isFirstFiltered?"hidden":""})),React.createElement("span",null,this.props.rank),React.createElement("div",_extends({tabIndex:this.props.isLastFiltered?null:"0"},_(this.moveRowDown.bind(this)),{className:this.props.isLastFiltered?"hidden":""}))):React.createElement("div",{className:"applicant_status"+(this.props.filteringByStatus?" filtering":"")},n[0].toUpperCase()),s=[];s.push(React.createElement("div",{key:"ID",className:"whole_match"+(this.props.filteringByID&&"#ID"!=this.props.detailOption&&!this.props.unbiasedMode?"":" hidden")},"#",a));var l,o=ne.First(e[t.c_First]),r=ne.Last(e[t.c_Last]);for(l in this.props.filteredBy){var c=this.props.filteredBy[l];if(Array.isArray(c)&&c.length){var p=void 0;try{if((p=e[t.c(l)])==te)continue}catch(e){continue}for(var u=[(p=ne[l](p)).substring(0,c.length?c[0][0]:p.length)],d=y.test(u[0]),h=0,m=c.length;h<m;h++){c[h][0]!=c[h][1]&&u.push(React.createElement("span",{key:h,className:"filtering"},p.substring(c[h][0],c[h][1])));var g=p.substring(c[h][1],h==m-1?p.length:c[h+1][0]),d=d&&y.test(g);u.push(g)}"First"==l?o=u:"Last"==l?r=u:(1<u.length||"string"!=typeof u[0])&&s.push(React.createElement("div",{key:l,className:d?"whole_match":"partial_match"},u))}}var f=this.makeHandlers(),E=this.props.unbiasedMode?React.createElement("div",{className:"applicant_id"+(this.props.filteringByID?" filtering":"")},React.createElement("span",null,"#",a)):React.createElement("div",{className:"applicant_name"},o," ",r),v=null;if("Icons"==this.props.detailOption||"#ID"==this.props.detailOption&&this.props.unbiasedMode){var R=[];try{R=(R=e[t.c("Icons")])==te?[]:R}catch(e){}v=React.createElement("div",{className:"applicant_icons"},R.map(function(e){return ee.ICONS[e]||null}))}else"#ID"==this.props.detailOption&&(v=React.createElement("div",{className:"applicant_id"},React.createElement("span",{className:this.props.filteringByID?"filtering":""},"#",a)));return React.createElement("button",_extends({className:"applicant_row applicant_status_".concat(n.replace(/\s+/g,"_"))+(this.props.hidden?" hidden":"")+(this.props.isFloating||e[t.c_ID]!=this.props.floatingRow.ID?"":" dragging")+(this.props.isFloating?" floating":"")+(this.props.borderRadiusTop?" br_top":"")+(this.props.borderRadiusBottom?" br_bottom":""),"data-applicant-id":a,"data-selected":this.props.selected,onClick:this.attemptFocusOnApplicant},this.props.isFloating?{style:{left:"".concat(this.props.floatingRow.initCoords[0],"px"),top:"".concat(this.props.floatingRow.initCoords[1],"px")}}:{},this.props.floatingRow.ref?{ref:this.props.floatingRow.ref}:{},f),i,E,React.createElement("div",{className:"applicant_match spacer"},s),v)}},{key:"attemptFocusOnApplicant",value:function(e){this.state.isBeingDragged||this.props.focusOnApplicant(e.currentTarget.getAttribute("data-applicant-id"))}},{key:"initRankingDrag",value:function(){this.state.pointerDownTimeout&&clearTimeout(this.state.pointerDownTimeout),window.getSelection?"function"==typeof getSelection().empty?getSelection().empty():"function"==typeof getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&"function"==typeof document.selection.empty&&document.selection.empty(),this.props.toggleRankingDrag(!0,this.props,this.props.row[this.props.data.c_ID],[this.state.pointerStartPos[0]-this.state.pointerStartElement.offsetLeft,this.state.pointerStartPos[1]-this.state.pointerStartElement.offsetTop],[this.state.pointerStartElement.offsetLeft,this.state.pointerStartElement.offsetTop],this.props.filteredIndex,this.state.pointerStartElement,this.state.touchID),this.setState({pointerDownTimeout:null})}},{key:"handler_rankingMousedown",value:function(e){function t(){document.removeEventListener("mouseup",a),document.removeEventListener("mousemove",n),document.removeEventListener("webkitmouseforcechanged",i)}this.setState({pointerDown:!0,pointerStartPos:[e.pageX,e.pageY],pointerStartElement:e.currentTarget,pointerDownTimeout:setTimeout(function(){t(),this.initRankingDrag()}.bind(this),400)});var a=function(e){t(),this.state.pointerDownTimeout&&clearTimeout(this.state.pointerDownTimeout),this.setState({pointerDown:!1,pointerStartPos:null,pointerStartElement:null,pointerDownTimeout:null})}.bind(this),n=function(e){5<Math.hypot(e.pageX-this.state.pointerStartPos[0],e.pageY-this.state.pointerStartPos[1])&&(t(),this.initRankingDrag())}.bind(this),i=function(e){e.webkitForce&&e.WEBKIT_FORCE_AT_MOUSE_DOWN&&e.WEBKIT_FORCE_AT_FORCE_MOUSE_DOWN&&e.webkitForce>=.9*e.WEBKIT_FORCE_AT_FORCE_MOUSE_DOWN-.1*e.WEBKIT_FORCE_AT_MOUSE_DOWN&&(t(),this.initRankingDrag())}.bind(this);document.addEventListener("mouseup",a),document.addEventListener("mousemove",n),document.addEventListener("webkitmouseforcechanged",i)}},{key:"handler_rankingTouchstart",value:function(e){var t=e.changedTouches[0];function o(){document.removeEventListener("touchend",a),document.removeEventListener("touchcancel",a),document.removeEventListener("touchforcechange",n)}this.setState({touchID:t.identifier,pointerDown:!0,pointerStartPos:[t.pageX,t.pageY],pointerStartElement:e.currentTarget,pointerDownTimeout:setTimeout(function(){o(),this.initRankingDrag()}.bind(this),400)});var a=function(e){var t,a=!1,n=_createForOfIteratorHelper(e.changedTouches);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.identifier==this.state.touchID){a=i;break}}}catch(e){n.e(e)}finally{n.f()}if(a){o(),this.state.pointerDownTimeout&&clearTimeout(this.state.pointerDownTimeout);var s=this.state.pointerStartElement;this.setState({touchID:null,pointerDown:!1,pointerStartPos:null,pointerStartElement:null,pointerDownTimeout:null});for(var l=document.elementFromPoint(a.clientX,a.clientY);l;l=l.parentElement)if(l==s){this.props.focusOnApplicant(l.getAttribute("data-applicant-id"));break}}}.bind(this),n=function(e){var t,a=!1,n=_createForOfIteratorHelper(e.changedTouches);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.identifier==this.state.touchID){a=i;break}}}catch(e){n.e(e)}finally{n.f()}a&&.85<=a.force&&(o(),this.initRankingDrag())}.bind(this);document.addEventListener("touchend",a),document.addEventListener("touchcancel",a),document.addEventListener("touchforcechange",n)}},{key:"makeHandlers",value:function(){if(this.props.hidden)return{};var e={};return this.props.rankable&&(e.onMouseDown=this.handler_rankingMousedown,e.onTouchStart=this.handler_rankingTouchstart),e}},{key:"moveRowUp",value:function(){this.props.moveRankingRow("UP",this.props.filteredIndex)}},{key:"moveRowDown",value:function(){this.props.moveRankingRow("DOWN",this.props.filteredIndex)}}]),a}(),O=function(){_inherits(a,k);var t=_createSuper(a);function a(e){return _classCallCheck(this,a),(e=t.call(this,e)).state={pollNumber:null},e.makeNewPoll=e.makeNewPoll.bind(_assertThisInitialized(e)),e.cancelPoll=e.cancelPoll.bind(_assertThisInitialized(e)),e.choosePollType=e.choosePollType.bind(_assertThisInitialized(e)),e.closePoll=e.closePoll.bind(_assertThisInitialized(e)),e.startSharingResults=e.startSharingResults.bind(_assertThisInitialized(e)),e.stopSharingResults=e.stopSharingResults.bind(_assertThisInitialized(e)),e}return _createClass(a,[{key:"render",value:function(){if(!z.active||z.master[0]!=user.uid)return null;var e=null;if(6==this.props.pollCreationStep){if(z.previousPollResults||this.props.previousPollResults)e=z.previousPollResults||this.props.previousPollResults;else{if(e=[],"selection"==this.props.previousPollData[0]){var t,a=z.poll_responses,n=Object.fromEntries(this.props.previousPollData[1].map(function(e){return[e,0]}));for(t in a)if("poll_data"!=t&&a[t][1])for(var i=a[t][2].split("|"),s=i.length-1;0<=s;s--)n[i[s]]++;var l,o=Math.max.apply(Math,_toConsumableArray(Object.values(n)));for(l in n)e.push([l,n[l]/o,n[l]])}else if("ranking"==this.props.previousPollData[0]){var r,c={},p=0;for(r in z.poll_responses)"poll_data"!=r&&z.poll_responses[r][1]&&(c[r]=z.poll_responses[r][2].split("|"),p++);for(var u=this.props.previousPollData[1].slice(),d=[];;){var h,m=!0,g={};for(h in c)0!=c[h].length&&(m=!1,g[c[h][0]]=g[c[h][0]]||[],g[c[h][0]].push(h));if(m){var f,E=d.length+1,v=_createForOfIteratorHelper(u);try{for(v.s();!(f=v.n()).done;){var R=f.value;d.push([R,E])}}catch(e){v.e(e)}finally{v.f()}break}for(;;){var _,y=-1/0,b=[];for(_ in g)g[_].length>y?(b=[_],y=g[_].length):g[_].length==y&&b.push(_);var A,S=1/0,k=[];for(A in g)g[A].length<S?(k=[A],S=g[A].length):g[A].length==S&&k.push(A);if(p/2<=y||S==y){var N,T=d.length+1,w=_createForOfIteratorHelper(b);try{for(w.s();!(N=w.n()).done;){var I,P=N.value;for(I in d.push([P,T]),u[u.indexOf(P)]=u[u.length-1],u.pop(),c){var C=c[I].indexOf(P);~C&&c[I].splice(C,1)}}}catch(e){w.e(e)}finally{w.f()}break}var O,M=_createForOfIteratorHelper(k);try{for(M.s();!(O=M.n()).done;){var D,U=O.value,L=_createForOfIteratorHelper(g[U]);try{for(L.s();!(D=L.n()).done;){for(var F=D.value,x=void 0,x=c[F].indexOf(U);x<c[F].length&&~k.indexOf(c[F][x]);x++);g[c[F][x]]=g[c[F][x]]||[],g[c[F][x]].push(F)}}catch(e){L.e(e)}finally{L.f()}delete g[U]}}catch(e){M.e(e)}finally{M.f()}}}var V=d[d.length-1][1]-1||1,e=d.map(function(e){return[e[0],(V-e[1]+1)/V,e[1]]})}e.sort(function(e,t){return parseInt(e[0],16)-parseInt(t[0],16)}),this.props.sharingPollResults&&Y.update({poll_results:JSON.stringify(e)})}z.previousPollResults=e,e=React.createElement("div",{className:"poll_res"},React.createElement("div",{className:"poll_res_container"},e.map(function(e){return React.createElement("div",{key:e[0],className:"poll_res_col"},React.createElement("div",{className:"poll_res_bar"},React.createElement("div",{style:{flexGrow:1-e[1]}},React.createElement("span",{className:.5<=e[1]?"hidden":""},e[2])),React.createElement("div",{style:{flexGrow:e[1]}},React.createElement("span",{className:.5<=e[1]?"":"hidden"},e[2]))),React.createElement("div",{className:"poll_res_name"},"#",e[0]))})))}return React.createElement("div",{id:"voting_controls"},React.createElement("div",null,"There ",1==z.applicants.length?"is":"are"," ",1==z.applicants.length?React.createElement("span",{className:"applicant_num"},"1 applicant"):React.createElement("span",{className:"applicant_num"},z.applicants.length," applicants")," left."),this.props.eliminatingApplicants?null:0==this.props.pollCreationStep?React.createElement("div",{className:"button_flex"},React.createElement("button",{onClick:this.makeNewPoll},"Create Poll")):1==this.props.pollCreationStep?React.createElement(React.Fragment,null,React.createElement("div",{className:"button_flex"},React.createElement("button",{className:"poll_type",onClick:this.choosePollType,"data-type":"ranking"},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 91.6 70"},React.createElement("path",{className:"fill_finalist",d:"M86.6,45H5c-2.8,0-5-2.2-5-5V30c0-2.8,2.2-5,5-5h81.6c2.8,0,5,2.2,5,5v10C91.6,42.8,89.3,45,86.6,45z"}),React.createElement("path",{className:"fill_finalist",d:"M86.6,20H5c-2.8,0-5-2.2-5-5V5c0-2.8,2.2-5,5-5h81.6c2.8,0,5,2.2,5,5v10C91.6,17.8,89.3,20,86.6,20z"}),React.createElement("path",{className:"fill_finalist",d:"M86.6,70H5c-2.8,0-5-2.2-5-5V55c0-2.8,2.2-5,5-5h81.6c2.8,0,5,2.2,5,5v10C91.6,67.8,89.3,70,86.6,70z"}),React.createElement("path",{className:"fill_text_color",d:"M9.5,15.6c-0.1,0-0.2,0-0.3-0.1s-0.1-0.2-0.1-0.3V6.9L6.7,8.8C6.6,8.9,6.5,8.9,6.4,8.9c-0.1,0-0.2-0.1-0.3-0.2L5.5,7.8C5.4,7.7,5.4,7.6,5.4,7.5c0-0.1,0.1-0.2,0.2-0.3l3.6-2.8c0.1-0.1,0.1-0.1,0.2-0.1c0.1,0,0.1,0,0.2,0H11c0.1,0,0.2,0,0.3,0.1c0.1,0.1,0.1,0.2,0.1,0.3v10.4c0,0.1,0,0.2-0.1,0.3c-0.1,0.1-0.2,0.1-0.3,0.1H9.5z"}),React.createElement("path",{className:"fill_text_color",d:"M4.9,40.7c-0.1,0-0.2,0-0.3-0.1c-0.1-0.1-0.1-0.2-0.1-0.3v-0.8c0-0.1,0-0.2,0.1-0.3c0-0.1,0.2-0.3,0.3-0.4l2.5-2.5c0.7-0.6,1.3-1,1.7-1.4c0.4-0.4,0.7-0.7,0.9-1.1c0.2-0.3,0.3-0.6,0.3-1c0-0.5-0.1-0.9-0.4-1.2s-0.7-0.4-1.2-0.4c-0.4,0-0.7,0.1-0.9,0.2c-0.3,0.2-0.5,0.4-0.6,0.6S7,32.5,7,32.9c0,0.1-0.1,0.2-0.2,0.3c-0.1,0.1-0.2,0.1-0.3,0.1H5.1c-0.1,0-0.2,0-0.2-0.1S4.7,33,4.7,32.9c0-0.5,0.1-0.9,0.3-1.3c0.2-0.4,0.4-0.8,0.8-1.2c0.3-0.3,0.8-0.6,1.3-0.8c0.5-0.2,1.1-0.3,1.7-0.3c0.9,0,1.6,0.1,2.2,0.4c0.6,0.3,1,0.7,1.3,1.2s0.4,1.1,0.4,1.7c0,0.5-0.1,1-0.3,1.4c-0.2,0.4-0.5,0.8-0.8,1.2c-0.4,0.4-0.8,0.8-1.3,1.2L8,38.8h4.6c0.1,0,0.2,0,0.3,0.1s0.1,0.2,0.1,0.3v1.1c0,0.1,0,0.2-0.1,0.3c-0.1,0.1-0.2,0.1-0.3,0.1H4.9z"}),React.createElement("path",{className:"fill_text_color",d:"M8.7,65.7c-0.7,0-1.4-0.1-1.9-0.3c-0.5-0.2-1-0.4-1.4-0.7c-0.4-0.3-0.6-0.6-0.8-1c-0.2-0.3-0.3-0.7-0.3-1c0-0.1,0-0.2,0.1-0.2s0.2-0.1,0.2-0.1h1.4c0.1,0,0.2,0,0.3,0.1c0.1,0,0.1,0.1,0.2,0.3c0.1,0.3,0.3,0.5,0.5,0.7c0.2,0.2,0.5,0.3,0.8,0.4s0.6,0.1,0.9,0.1c0.6,0,1.1-0.2,1.5-0.5c0.4-0.3,0.6-0.7,0.6-1.3s-0.2-1-0.5-1.2c-0.4-0.3-0.8-0.4-1.5-0.4H7.2c-0.1,0-0.2,0-0.3-0.1s-0.1-0.2-0.1-0.3v-0.7c0-0.1,0-0.2,0.1-0.3C6.9,59.1,7,59,7,59l2.9-2.8H5.3c-0.1,0-0.2,0-0.3-0.1s-0.1-0.2-0.1-0.3v-1.1c0-0.1,0-0.2,0.1-0.3c0.1-0.1,0.2-0.1,0.3-0.1h6.9c0.1,0,0.2,0,0.3,0.1c0.1,0.1,0.1,0.2,0.1,0.3v1c0,0.1,0,0.2-0.1,0.3c0,0.1-0.1,0.1-0.1,0.2L9.6,59l0.2,0c0.7,0.1,1.2,0.2,1.7,0.4s0.9,0.6,1.2,1c0.3,0.5,0.4,1,0.4,1.7c0,0.7-0.2,1.3-0.6,1.9c-0.4,0.5-0.9,0.9-1.6,1.2C10.3,65.5,9.6,65.7,8.7,65.7z"})),"Ranking"),React.createElement("button",{className:"poll_type",onClick:this.choosePollType,"data-type":"selection"},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 91.6 70"},React.createElement("path",{className:"fill_finalist",d:"M86.6,45H5c-2.8,0-5-2.2-5-5V30c0-2.8,2.2-5,5-5h81.6c2.8,0,5,2.2,5,5v10C91.6,42.8,89.3,45,86.6,45z"}),React.createElement("path",{className:"fill_finalist",d:"M86.6,20H5c-2.8,0-5-2.2-5-5V5c0-2.8,2.2-5,5-5h81.6c2.8,0,5,2.2,5,5v10C91.6,17.8,89.3,20,86.6,20z"}),React.createElement("path",{className:"fill_finalist",d:"M86.6,70H5c-2.8,0-5-2.2-5-5V55c0-2.8,2.2-5,5-5h81.6c2.8,0,5,2.2,5,5v10C91.6,67.8,89.3,70,86.6,70z"}),React.createElement("path",{fill:"white",d:"M15.5,16.5h-11c-0.6,0-1-0.4-1-1v-11c0-0.6,0.4-1,1-1h11c0.6,0,1,0.4,1,1v11C16.5,16.1,16.1,16.5,15.5,16.5z"}),React.createElement("path",{className:"fill_theme_color",d:"M14,15H6c-0.6,0-1-0.4-1-1V6c0-0.6,0.4-1,1-1h8c0.6,0,1,0.4,1,1v8C15,14.6,14.6,15,14,15z"}),React.createElement("path",{fill:"white",d:"M15.5,41.5h-11c-0.6,0-1-0.4-1-1v-11c0-0.6,0.4-1,1-1h11c0.6,0,1,0.4,1,1v11C16.5,41.1,16.1,41.5,15.5,41.5z"}),React.createElement("path",{className:"fill_gray",opacity:".5",d:"M14,40H6c-0.6,0-1-0.4-1-1v-8c0-0.6,0.4-1,1-1h8c0.6,0,1,0.4,1,1v8C15,39.6,14.6,40,14,40z"}),React.createElement("path",{fill:"white",d:"M15.5,66.5h-11c-0.6,0-1-0.4-1-1v-11c0-0.6,0.4-1,1-1h11c0.6,0,1,0.4,1,1v11C16.5,66.1,16.1,66.5,15.5,66.5z"}),React.createElement("path",{className:"fill_gray",opacity:".5",d:"M14,65H6c-0.6,0-1-0.4-1-1v-8c0-0.6,0.4-1,1-1h8c0.6,0,1,0.4,1,1v8C15,64.6,14.6,65,14,65z"})),"Selection")),React.createElement("button",{className:"destructive",onClick:this.cancelPoll},"Cancel")):2==this.props.pollCreationStep?React.createElement(React.Fragment,null,React.createElement("div",{className:"direction_text"},"Choose at least two applicants for the poll."),React.createElement("div",{className:"button_flex"},React.createElement("button",{className:"destructive",onClick:this.cancelPoll},"Cancel"),React.createElement("button",{disabled:this.props.selectedApplicants.length<2,onClick:this.onFinishSelectApplicants.bind(this)},"Next"))):3==this.props.pollCreationStep?React.createElement(React.Fragment,null,React.createElement("div",{className:"direction_text"},"How many should each person ","ranking"==this.props.pollType?"rank":"select","?"),React.createElement("div",{className:"button_flex"},React.createElement("input",{type:"number",autoFocus:!0,defaultValue:this.state.pollNumber,max:this.props.pollApplicants.length,min:1,step:1,onChange:this.onChangePollNumber.bind(this)}),React.createElement("button",{disabled:!this.state.pollNumber,onClick:this.sendOutPoll.bind(this)},"Finish")),React.createElement("button",{className:"destructive",onClick:this.cancelPoll},"Cancel")):4==this.props.pollCreationStep?React.createElement("div",{className:"direction_text"},"Sending out poll..."):5==this.props.pollCreationStep?React.createElement(React.Fragment,null,React.createElement("div",{className:"direction_text"},"Your poll has been received by:"),React.createElement("div",{className:"poll_receivers_list"},z.poll_receivers.map(function(e){return React.createElement("div",{key:e[0],className:"poll_receiver"+(e[2]?" ready":" not_ready")},React.createElement("span",{className:"poll_receiver_name"},e[1]),React.createElement("span",{className:"poll_receiver_status"},e[2]?"Ready":"Not Ready"))})),React.createElement("div",{className:"button_flex"},React.createElement("button",{onClick:this.closePoll,disabled:!this.props.pollSubmitted},"Close Poll")),this.props.pollSubmitted?null:React.createElement("div",{className:"direction_text",style:{marginTop:".5rem"}},"Please submit your responses before closing the poll.")):6==this.props.pollCreationStep?React.createElement(React.Fragment,null,e,React.createElement("div",{className:"button_flex"},this.props.sharingPollResults?React.createElement("button",{onClick:this.stopSharingResults},"Stop Sharing"):z.previousPollResults?React.createElement("button",{onClick:this.startSharingResults},"Share Results"):null,React.createElement("button",{onClick:this.makeNewPoll},"Create New Poll"))):null,0==this.props.pollCreationStep||6==this.props.pollCreationStep?this.props.eliminatingApplicants?React.createElement(React.Fragment,null,React.createElement("div",{className:"direction_text"},"Select the applicants you want to eliminate from consideration."),React.createElement("div",{className:"button_flex"},React.createElement("button",{className:"destructive",onClick:this.props.cancelEliminatingApplicants},"Cancel"),React.createElement("button",{onClick:this.props.finishEliminatingApplicants},"Done"))):React.createElement("button",{onClick:this.props.beginEliminatingApplicants},"Eliminate Applicants"):null)}},{key:"makeNewPoll",value:function(){this.props.cancelEliminatingApplicants(),this.props.setAppState({pollCreationStep:1,pollType:null,pollApplicants:[]}),this.setState({pollNumber:null})}},{key:"choosePollType",value:function(e){this.props.setAppState({pollCreationStep:2,pollType:e.currentTarget.getAttribute("data-type")}),this.props.toggleApplicantSelection(!0)}},{key:"onFinishSelectApplicants",value:function(){this.props.setAppState({pollCreationStep:3,pollApplicants:this.props.selectedApplicants}),this.setState({pollNumber:"ranking"==this.props.pollType?Math.min(3,this.props.selectedApplicants.length):Math.ceil(this.props.selectedApplicants.length/4)}),this.props.toggleApplicantSelection(!1)}},{key:"onChangePollNumber",value:function(e){this.setState({pollNumber:e.currentTarget.checkValidity()?+e.currentTarget.value:null})}},{key:"cancelPoll",value:function(e){this.props.setAppState({pollCreationStep:0,pollType:null}),this.setState({pollNumber:null}),this.props.toggleApplicantSelection(!1)}},{key:"sendOutPoll",value:function(e){Y.set({poll_data:[this.props.pollType,this.props.pollApplicants.join("|"),this.state.pollNumber]}).then(this.props.subscribeToPollResponses),this.props.setAppState({pollCreationStep:4}),z.previousPollResults=null}},{key:"closePoll",value:function(e){this.props.unsubscribeFromPollResponses(),Y.set({poll_data:null}).then(this.props.reloadSearchResults),this.props.setAppState({pollCreationStep:6,sharingPollResults:this.props.autoSharePollResults})}},{key:"startSharingResults",value:function(e){Y.update({poll_results:JSON.stringify(z.previousPollResults)}),this.props.setAppState({sharingPollResults:!0})}},{key:"stopSharingResults",value:function(e){Y.update({poll_results:null}),this.props.setAppState({sharingPollResults:!1})}}]),a}(),M=function(){_inherits(a,k);var t=_createSuper(a);function a(e){return _classCallCheck(this,a),(e=t.call(this,e)).state={edits:{},editing:!1,uploading:!1,pendingRow:null,pendingSheetsRow:null,pendingRowIndex:null,failedUpload:!1,warnUnsavedEdit:!1,activeUnusedIcons:!1},window.addEventListener("keydown",function(e){"Escape"!=e.key&&"Escape"!=e.code||this.attemptUnfocusApplicant()}.bind(_assertThisInitialized(e))),e.unfocusApplicant=e.unfocusApplicant.bind(_assertThisInitialized(e)),e.attemptUnfocusApplicant=e.attemptUnfocusApplicant.bind(_assertThisInitialized(e)),e.onClickModal=e.onClickModal.bind(_assertThisInitialized(e)),e.onEditPrompt=e.onEditPrompt.bind(_assertThisInitialized(e)),e}return _createClass(a,[{key:"render",value:function(){var e,t,a,n,i,s=this,l=this.props.spreadsheetData,o=this.props.year,r=this.props.id,c=[],p=[],u=[];if(l&&!isNaN(o)){var d=function(e,t){try{var a=_[l.c(e)];return a==te?t:a}catch(e){return t}},h=function(e){if(e in ee[o].eliminators){var t=d(e,te);return ee[o].eliminators[e](t)}return!1};document.documentElement.setAttribute("data-is-focusing","true");var m,g=[],f=_createForOfIteratorHelper(l.rows);try{for(f.s();!(m=f.n()).done;){var E=m.value;parseInt(E[l.c_ID],16)==r&&g.push(E)}}catch(e){f.e(e)}finally{f.f()}if(1!=g.length)return null;var v,R,_=g[0],y=ne.First(_[l.c_First])+" "+ne.Last(_[l.c_Last]),b=ne.Email(d("Email",te)),A="#"+(o-2e3)+"-"+_[l.c_ID],S=ne.Status(_[l.c_Status]),k=ne.Income(d("Income",te)),N=h("Income"),T=ne.Members(d("Members",te)),w=h("Members"),I=ne.EFC(d("EFC",te)),P=h("EFC"),C=ne.College(d("College",te)),O=h("College"),M=ne.Loans(d("Loans",te)),D=h("Loans"),U=ne.Campus_Living(d("Campus_Living",te)),L=h("Campus_Living"),F=ne.Parent1_Education(d("Parent1_Education",te)),x=h("Parent1_Education"),V=ne.Parent2_Education(d("Parent2_Education",te)),Y=h("Parent2_Education"),z=ne.Location(d("Location",te)),B=h("Location"),H=ne.Year(d("Year",te)),j=h("Year");this.props.unbiasedMode?e="(***) ***-****":(e=ne.Phone(d("Phone",te)),t=h("Phone")),a=this.props.unbiasedMode?"— / — / —":ne.Pronouns(d("Pronouns",te)),this.props.unbiasedMode?R=(v=d("Birthday",te))==te||isNaN(v.valueOf())?"N/A":(R=new Date,v=new Date(v),X=R.getFullYear()-v.getFullYear(),v.setFullYear(R.getFullYear()),"".concat(X-=0<v-R?1:0," year").concat(1==X?"":"s"," old")):(R=ne.Birthday(d("Birthday",te)),n=h("Birthday"));for(var G=ee[this.props.year],W=0,$=G.prompts.length;W<$;W++){var K=G.mapping.Prompts[W],K=l.headers.indexOf(K);~K&&c.push(React.createElement("div",{key:W,"data-prompt-index":W,className:"modal_prompt"+(this.state.editing?" editing":"")},React.createElement("h4",{className:"modal_header"},React.createElement("span",null,G.prompts[W])),this.state.editing?React.createElement(ie,{defaultValue:_[K].trim(),"data-index":W,onChange:this.onEditPrompt}):React.createElement("div",{className:"modal_prompt_response"},_[K].trim())))}(X=d("Comments","").trim()).match(/^[nN]\s*\/?\s*[aA]$/)&&(X="");var Q="Icons"in this.state.edits?this.state.edits.Icons:d("Icons",[]),p=Q.map(function(e){return ee.ICONS[e]||null});if(this.state.editing){for(var u=Object.keys(ee.ICONS),Z=Q.length-1;0<=Z;Z--){var q=u.indexOf(Q[Z]);~q&&u.splice(q,1)}u=u.map(function(e){return ee.ICONS[e]||null});for(var J=Q.length-1;0<=J;J--)null!==p[J]&&(p[J]=React.createElement("div",{className:"modal_icon_container"},p[J]),p.splice(J+1,0,React.createElement("button",{key:Q[J]+"-deleter",className:"modal_icon_deleter nostyle"},React.createElement("div",null))))}}else document.documentElement.setAttribute("data-is-focusing","false");var h=N||w||P||x||Y||O||D||L||B||j||t||n,X=this.state.editing||""!=X?React.createElement("div",{className:"modal_prompt"+(this.state.editing?" editing":"")},React.createElement("h4",{className:"modal_header"},React.createElement("span",null,"Additional Comments")),this.state.editing?React.createElement(ie,{defaultValue:X,onChange:this.onEditComments.bind(this)}):React.createElement("div",{className:"modal_prompt_response"},X)):null;return this.state.uploading?i="Saving Changes...":this.state.failedUpload?i=React.createElement(React.Fragment,null,'The changes you made failed to save. Make sure you have a stable internet connection and "Edit" access on the Google Sheet.',React.createElement("div",{style:{textAlign:"center",marginTop:".5rem"}},React.createElement("button",{onClick:this.onRetryUpload.bind(this)},"Try Again"),React.createElement("button",{className:"destructive",onClick:this.onAbortEdit.bind(this)},"Delete Changes"))):this.state.warnUnsavedEdit&&(i=React.createElement(React.Fragment,null,"You have unsaved changes. Do you want to go back and save them or exit anyway?",React.createElement("div",{style:{textAlign:"center",marginTop:".5em"}},React.createElement("button",{onClick:function(e){return s.setState({warnUnsavedEdit:!1})}},"Go Back"),React.createElement("button",{className:"destructive",onClick:this.unfocusApplicant},"Exit")))),React.createElement("div",{id:"modal_back",onClick:this.attemptUnfocusApplicant},React.createElement("div",{id:"applicant_modal",onClick:this.onClickModal},i?React.createElement("div",{id:"modal_message"},i):null,React.createElement("div",{id:"modal_content"},React.createElement("div",{id:"modal_scroller",onScroll:this.onScroll.bind(this)},this.props.unbiasedMode?React.createElement("h1",null,A):React.createElement("h1",null,this.state.editing?React.createElement("input",{type:"text",defaultValue:y,"data-original-value":y,onChange:this.onEditName.bind(this),onBlur:this.onBlurName.bind(this),pattern:"\\s*[0-9A-Za-zÀ-ÖØ-öø-ÿ]+\\s+[0-9A-Za-zÀ-ÖØ-öø-ÿ]+(?:\\s+[0-9A-Za-zÀ-ÖØ-öø-ÿ]+)*\\s*"}):y),this.props.unbiasedMode?null:React.createElement("h2",null,this.state.editing?React.createElement("input",{type:"email",defaultValue:b,"data-original-value":b,onChange:this.onEditEmail.bind(this),onBlur:this.onBlurField.bind(this,"Email")}):b," ",React.createElement("span",null,A)),React.createElement("h3",null,this.state.editing?React.createElement("select",{defaultValue:S,onChange:this.onEditStatus.bind(this)},React.createElement("option",null,"Applicant"),React.createElement("option",null,"2nd Read"),React.createElement("option",null,"Finalist"),React.createElement("option",null,"Recipient"),React.createElement("option",null,"Ineligible")):S),React.createElement("div",{className:"modal_icons"+(this.state.editing?" editing":p.length?"":" hidden"),onClick:this.onDeleteIcon.bind(this)},p,this.state.editing&&u.length?React.createElement("svg",{className:"modal_icon add_icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",onClick:function(e){return s.state.activeUnusedIcons?null:(e.stopPropagation(),s.setState({activeUnusedIcons:!0}))}},React.createElement("title",null,"Add another"),React.createElement("path",{d:"M10,40,40,40,40,10,60,10,60,40,90,40,90,60,60,60,60,90,40,90,40,60,10,60Z"})):null),this.state.editing?React.createElement("div",{className:"modal_unused_icons"+(this.state.activeUnusedIcons?"":" hidden"),onClick:this.onAddIcon.bind(this)},React.createElement("div",null,u)):null,h&&"Applicant"==S&&ae&&!this.state.editing?React.createElement("button",{className:"destructive",onClick:function(e){return s.setState({edits:{Status:ee.Enum.STATUS.INELIGIBLE}},s.onEndEdit.bind(s))}},"Make Ineligible"):null,React.createElement("section",{className:"modal_section"},React.createElement("h4",{className:"modal_header"},React.createElement("span",null,"Financial Info")),React.createElement("div",{className:"modal_row"},React.createElement("div",{className:"field",style:{width:"15rem"}},this.state.editing?React.createElement("input",{type:"text",defaultValue:k,"data-original-value":k,onChange:this.onEditIncome.bind(this),onBlur:this.onBlurField.bind(this,"Income"),pattern:"\\s*(?:\\$?\\s*\\d+(?:[,\\s]\\d*)*\\s*(?:\\.\\s*\\d*(?:\\s\\d*)*)?(?:\\s*[kK])?(?:\\s*\\+|\\s*[-–]\\s*\\$?\\s*\\d+(?:[,\\s]\\d*)*\\s*(?:\\.\\s*\\d*(?:\\s\\d*)*)?(?:\\s*[kK])?)?|[nN]\\s*\\/?\\s*[aA])\\s*"}):React.createElement("span",{className:N?"eliminable":""},k),React.createElement("span",null,"Household Income")),React.createElement("div",{className:"field",style:{width:"15rem"}},this.state.editing?React.createElement("input",{type:"text",defaultValue:T,"data-original-value":T,onChange:this.onEditHouseholdMembers.bind(this),onBlur:this.onBlurField.bind(this,"Members"),pattern:"\\s*(?:\\d+(?:[,\\s]\\d*)*\\s*(?:\\.\\s*\\d*(?:\\s\\d*)*)?(?:\\s*[kK])?|[nN]\\s*\\/?\\s*[aA])\\s*"}):React.createElement("span",{className:w?"eliminable":""},T),React.createElement("span",null,"Household Members")),React.createElement("div",{className:"field",style:{width:"15rem"}},this.state.editing?React.createElement("input",{type:"text",defaultValue:I,"data-original-value":I,onChange:this.onEditEFC.bind(this),onBlur:this.onBlurField.bind(this,"EFC")}):React.createElement("span",{className:P?"eliminable":""},I),React.createElement("span",null,"EFC")))),React.createElement("section",{className:"modal_section"},React.createElement("h4",{className:"modal_header"},React.createElement("span",null,"College Info")),React.createElement("div",{className:"modal_row"},React.createElement("div",{className:"field",style:{width:"18rem"}},this.state.editing?React.createElement("input",{type:"text",defaultValue:C,"data-original-value":C,onChange:this.onEditCollege.bind(this),onBlur:this.onBlurField.bind(this,"College")}):React.createElement("span",{className:O?"eliminable":""},C),React.createElement("span",null,"College")),React.createElement("div",{className:"field",style:{width:"5rem"}},this.state.editing?React.createElement("select",{defaultValue:M,onChange:this.onEditLoans.bind(this)},React.createElement("option",null,"Yes"),React.createElement("option",null,"No"),React.createElement("option",null,"N/A")):React.createElement("span",{className:D?"eliminable":""},M),React.createElement("span",null,"Loans")),React.createElement("div",{className:"field",style:{width:"18rem"}},this.state.editing?React.createElement("select",{defaultValue:U,onChange:this.onEditCampusLiving.bind(this)},React.createElement("option",null,"On campus"),React.createElement("option",null,"Off campus w/ rent"),React.createElement("option",null,"Off campus w/o rent"),React.createElement("option",null,"Unknown"),React.createElement("option",null,"N/A")):React.createElement("span",{className:L?"eliminable":""},U),React.createElement("span",null,"Campus Living")))),React.createElement("section",{className:"modal_section"},React.createElement("h4",{className:"modal_header"},React.createElement("span",null,"Background")),React.createElement("div",{className:"modal_row"},React.createElement("div",{className:"field",style:{width:"18rem"}},this.state.editing?React.createElement("input",{type:"text",defaultValue:z,"data-original-value":z,onChange:this.onEditLocation.bind(this),onBlur:this.onBlurField.bind(this,"Location")}):React.createElement("span",{className:B?"eliminable":""},z),React.createElement("span",null,"Location")),React.createElement("div",{className:"field",style:{width:"18rem"}},this.state.editing?React.createElement("select",{defaultValue:H,onChange:this.onEditYear.bind(this)},React.createElement("option",null,"High school student"),React.createElement("option",null,"First year college student"),React.createElement("option",null,"Returning college student"),React.createElement("option",null,"Graduate student"),React.createElement("option",null,"Transfer student"),React.createElement("option",null,"N/A")):React.createElement("span",{className:j?"eliminable":""},H),React.createElement("span",null,"Year"))),React.createElement("div",{className:"modal_row"},React.createElement("div",{className:"field",style:{width:"18rem"}},this.state.editing?React.createElement("select",{defaultValue:F,onChange:this.onEditPar1Education.bind(this)},React.createElement("option",null,"No diploma"),React.createElement("option",null,"HS diploma or equivalent"),React.createElement("option",null,"Some college"),React.createElement("option",null,"College degree"),React.createElement("option",null,"Multiple degrees"),React.createElement("option",null,"No parent 1")):React.createElement("span",{className:x?"eliminable":""},F),React.createElement("span",null,"Parent 1 Education")),React.createElement("div",{className:"field",style:{width:"18rem"}},this.state.editing?React.createElement("select",{defaultValue:V,onChange:this.onEditPar2Education.bind(this)},React.createElement("option",null,"No diploma"),React.createElement("option",null,"HS diploma or equivalent"),React.createElement("option",null,"Some college"),React.createElement("option",null,"College degree"),React.createElement("option",null,"Multiple degrees"),React.createElement("option",null,"No parent 2")):React.createElement("span",{className:Y?"eliminable":""},V),React.createElement("span",null,"Parent 2 Education")))),React.createElement("section",{className:"modal_section"},React.createElement("h4",{className:"modal_header"},React.createElement("span",null,"Personal Info")),React.createElement("div",{className:"modal_row"},React.createElement("div",{className:"field",style:{width:"15rem"}},this.state.editing&&!this.props.unbiasedMode?React.createElement("input",{type:"text",defaultValue:R,"data-original-value":R,onChange:this.onEditBirthday.bind(this),onBlur:this.onBlurField.bind(this,"Birthday")}):React.createElement("span",{className:n?"eliminable":""},R),React.createElement("span",null,"Birthday")),React.createElement("div",{className:"field",style:{width:"15rem"}},this.state.editing&&!this.props.unbiasedMode?React.createElement("input",{type:"tel",defaultValue:e,"data-original-value":e,onChange:this.onEditPhoneNumber.bind(this),onBlur:this.onBlurField.bind(this,"Phone"),pattern:"\\s*(?:(?:\\+\\s*1\\s*)?(?:\\(\\s*\\d\\s*\\d\\s*\\d\\s*\\)|\\d\\s*\\d\\s*\\d)\\s*(?:-\\s*)?\\d\\s*\\d\\s*\\d\\s*(?:-\\s*)?\\d\\s*\\d\\s*\\d\\s*\\d|[nN]\\s*\\/?\\s*[aA])\\s*"}):React.createElement("span",{className:t?"eliminable":""},e),React.createElement("span",null,"Phone Number")),React.createElement("div",{className:"field",style:{width:"15rem"}},this.state.editing&&!this.props.unbiasedMode?React.createElement("input",{type:"text",defaultValue:a,"data-original-value":a,onChange:this.onEditPronouns.bind(this),onBlur:this.onBlurField.bind(this,"Pronouns")}):React.createElement("span",null,a),React.createElement("span",null,"Pronouns")))),c,X),React.createElement("div",{id:"modal_btn_container"},this.state.editing?React.createElement("button",{onClick:this.onEndEdit.bind(this)},"Save"):null,this.state.editing?React.createElement("button",{className:"destructive",onClick:this.onAbortEdit.bind(this)},"Cancel"):null,ae&&!this.state.editing?React.createElement("button",{onClick:this.onStartEdit.bind(this)},"Edit"):null,this.state.editing?null:React.createElement("button",{onClick:this.attemptUnfocusApplicant.bind(this)},"Close")))))}},{key:"onScroll",value:function(e){var t=e.currentTarget,a=t.scrollTop,e=t.scrollHeight-t.scrollTop-t.clientHeight;t.style.boxShadow="0 1.2em 0.25em -1em rgba(0,0,0,".concat(Math.min(a/16*.4,.4),") inset, 0 -1.2em 0.25em -1em rgba(0,0,0,").concat(Math.min(e/16*.4,.4),") inset")}},{key:"onClickModal",value:function(e){e.stopPropagation(),this.state.activeUnusedIcons&&this.setState({activeUnusedIcons:!1})}},{key:"attemptUnfocusApplicant",value:function(){this.props.active&&(this.state.editing&&0!=Object.keys(this.state.edits).length?this.setState({warnUnsavedEdit:!0}):this.unfocusApplicant())}},{key:"unfocusApplicant",value:function(e){this.onAbortEdit(e),this.props.unfocusApplicant()}},{key:"onStartEdit",value:function(e){e&&e.currentTarget.disabled||this.setState({editing:!0})}},{key:"onAbortEdit",value:function(e){this.setState({editing:!1,edits:{},uploading:!1,pendingRow:null,pendingSheetsRow:null,pendingRowIndex:null,failedUpload:!1,warnUnsavedEdit:!1})}},{key:"onRetryUpload",value:function(e){"number"==typeof this.state.pendingRowIndex&&this.state.pendingSheetsRow&&(gapi.client.sheets.spreadsheets.values.update({spreadsheetId:ee[this.props.year].id,range:"'".concat(ee[this.props.year].sheet,"'!").concat(this.state.pendingRowIndex+2,":").concat(this.state.pendingRowIndex+2),valueInputOption:"RAW"},{values:[this.state.pendingSheetsRow]}).then(function(){this.props.spreadsheetData.rows[this.state.pendingRowIndex]=this.state.pendingRow,this.setState({uploading:!1,pendingRow:null,pendingSheetsRow:null,pendingRowIndex:null})}.bind(this),function(e){this.setState({uploading:!1,failedUpload:!0})}.bind(this)),this.setState({uploading:!0,failedUpload:!1}))}},{key:"onEndEdit",value:function(){if(this.props.spreadsheetData&&this.props.year&&this.props.id&&0!=Object.keys(this.state.edits).length){var e,t=this.props.spreadsheetData,a=t.rows[this.props.applicantRowIndex].slice();for(e in this.state.edits)if("Prompts"==e)for(var n in this.state.edits.Prompts){var i=t.headers.indexOf(ee[this.props.year].mapping.Prompts[n]);~i&&(a[i]=this.state.edits.Prompts[n])}else{var s=void 0;try{s=t.c(e)}catch(e){continue}a[s]=this.state.edits[e]}var l,o=ee[this.props.year].translate.to,r=a.slice();for(l in o){var c=void 0;try{c=t.c(l)}catch(e){continue}var p=o[l](a[c]);r[c]=p}gapi.client.sheets.spreadsheets.values.update({spreadsheetId:ee[this.props.year].id,range:"'".concat(ee[this.props.year].sheet,"'!").concat(this.props.applicantRowIndex+2,":").concat(this.props.applicantRowIndex+2),valueInputOption:"RAW"},{values:[r]}).then(function(){this.props.spreadsheetData.rows[this.state.pendingRowIndex]=this.state.pendingRow,this.setState({uploading:!1,pendingRow:null,pendingSheetsRow:null,pendingRowIndex:null})}.bind(this),function(e){this.setState({uploading:!1,failedUpload:!0})}.bind(this)),this.setState({editing:!1,edits:{},uploading:!0,failedUpload:!1,pendingRow:a,pendingSheetsRow:r,pendingRowIndex:this.props.applicantRowIndex})}else this.setState({editing:!1,edits:{},uploading:!1,pendingRow:null,pendingSheetsRow:null,pendingRowIndex:null,failedUpload:!1})}},{key:"onMakeEdit",value:function(e,t){"Prompt"==e.substring(0,6)?(this.state.edits.Prompts=this.state.edits.Prompts||{},this.state.edits.Prompts[+e.substring(6)]=t):this.state.edits[e]=t}},{key:"onRemoveEdit",value:function(e){"Prompt"==e.substring(0,6)?(this.state.edits.Prompts=this.state.edits.Prompts||{},delete this.state.edits.Prompts[+e.substring(6)],0==Object.keys(this.state.edits.Prompts).length&&delete this.state.edits.Prompts):delete this.state.edits[e]}},{key:"onBlurField",value:function(e,t){var a=this.state.edits[e];t.currentTarget.value=a?ne[e](a):t.currentTarget.getAttribute("data-original-value")}},{key:"onAddIcon",value:function(e){e.stopPropagation();for(var t,a,n=e.target;n!=e.currentTarget&&!(t=n.getAttribute("data-icon-name"));)n=n.parentNode;if(t){if("Icons"in this.state.edits)a=this.state.edits.Icons;else{var i,s=this.props.spreadsheetData;try{i=s.c("Icons")}catch(e){return}a=s.rows[this.props.applicantRowIndex][i].slice()}~a.indexOf(t)||(a.push(t),a.length==Object.keys(ee.ICONS).length&&this.setState({activeUnusedIcons:!1}),this.onMakeEdit("Icons",a),this.forceUpdate())}}},{key:"onDeleteIcon",value:function(e){for(var t,a,n=e.target;n!=e.currentTarget&&!(t=n.getAttribute("data-icon-name")||n.previousElementSibling&&n.previousElementSibling.getAttribute("data-icon-name"));)n=n.parentNode;if(t){if(e.stopPropagation(),"Icons"in this.state.edits)a=this.state.edits.Icons;else{var i=this.props.spreadsheetData;try{s=i.c("Icons")}catch(e){return}a=i.rows[this.props.applicantRowIndex][s].slice()}var s=a.indexOf(t);~s&&(a.splice(s,1),this.onMakeEdit("Icons",a),this.forceUpdate())}}},{key:"onEditStatus",value:function(e){this.onMakeEdit("Status",{Ineligible:ee.Enum.STATUS.INELIGIBLE,Applicant:ee.Enum.STATUS.APPLICANT,"2nd Read":ee.Enum.STATUS.SECOND_READ,Finalist:ee.Enum.STATUS.FINALIST,Recipient:ee.Enum.STATUS.RECIPIENT}[e.currentTarget.value]||te)}},{key:"onEditName",value:function(e){var t=f(e.currentTarget.value.trim()).split(/\s+/);1!=t.length&&e.currentTarget.checkValidity()?(this.onMakeEdit("First",ne.First(t[0])),this.onMakeEdit("Last",ne.Last(t.slice(1).join(" ")))):(this.onRemoveEdit("First"),this.onRemoveEdit("Last"))}},{key:"onBlurName",value:function(e){var t=this.state.edits.First,a=this.state.edits.Last;e.currentTarget.value=t&&a?ne.First(t)+" "+ne.Last(a):e.currentTarget.getAttribute("data-original-value")}},{key:"onEditEmail",value:function(e){var t=e.currentTarget.value.trim();e.currentTarget.checkValidity()&&t?this.onMakeEdit("Email",ne.Email(t)):this.onRemoveEdit("Email")}},{key:"onEditEFC",value:function(e){var t=e.currentTarget.value.trim();e.currentTarget.checkValidity()?t.match(/^[nN]\s*\/?\s*[aA]$/)||!t?this.onMakeEdit("EFC",te):"undocumented"==t.toLowerCase()?this.onMakeEdit("EFC",ee.Enum.EFC.UNDOCUMENTED):("k"==(e=t.replace(/[,\s\$]/g,"").toLowerCase())[e.length-1]&&(e=1e3*e.substring(0,e.length-1)),isNaN(e)||!isFinite(e)?this.onMakeEdit("EFC",ee.makeWriteIn(t)):this.onMakeEdit("EFC",Math.floor(e))):this.onRemoveEdit("EFC")}},{key:"onEditHouseholdMembers",value:function(e){var t=e.currentTarget.value.trim();e.currentTarget.checkValidity()?t.match(/^[nN]\/?[aA]$/)||!t?this.onMakeEdit("Members",te):("k"==(t=t.replace(/[,\s]/g,"").toLowerCase())[t.length-1]&&(t=1e3*t.substring(0,t.length-1)),this.onMakeEdit("Members",Math.floor(t))):this.onRemoveEdit("Members")}},{key:"onEditIncome",value:function(e){var t=e.currentTarget.value.trim();e.currentTarget.checkValidity()?t.match(/^[nN]\s*\/?\s*[aA]$/)||!t?this.onMakeEdit("Income",te):1==(t=(t=t.replace(/[,\s\$]/g,"").toLowerCase()).split(/[-–]/)).length?"+"==(t=t[0])[t.length-1]?("k"==(t=t.substring(0,t.length-1))[t.length-1]&&(t=1e3*t.substring(0,t.length-1)),this.onMakeEdit("Income",[Math.floor(t),1/0])):("k"==t[t.length-1]&&(t=1e3*t.substring(0,t.length-1)),this.onMakeEdit("Income",Math.floor(t))):("k"==t[0][t[0].length-1]&&(t[0]=1e3*t[0].substring(0,t[0].length-1)),"k"==t[1][t[1].length-1]&&(t[1]=1e3*t[1].substring(0,t[1].length-1)),this.onMakeEdit("Income",[Math.floor(t[0]),Math.floor(t[1])])):this.onRemoveEdit("Income")}},{key:"onEditCollege",value:function(e){var t=e.currentTarget.value.trim();e.currentTarget.checkValidity()?t.match(/^[nN]\s*\/?\s*[aA]$/)||!t?this.onMakeEdit("College",te):this.onMakeEdit("College",ne.College(t)):this.onRemoveEdit("College")}},{key:"onEditLoans",value:function(e){this.onMakeEdit("Loans",{Yes:ee.Enum.LOANS.YES,No:ee.Enum.LOANS.NO,"N/A":te}[e.currentTarget.value]||te)}},{key:"onEditCampusLiving",value:function(e){this.onMakeEdit("Campus_Living",{"On campus":ee.Enum.CAMPUS_LIVING.ON_CAMPUS,"Off campus w/ rent":ee.Enum.CAMPUS_LIVING.OFF_CAMPUS_RENT,"Off campus w/o rent":ee.Enum.CAMPUS_LIVING.OFF_CAMPUS_NO_RENT,Unknown:ee.Enum.CAMPUS_LIVING.UNKNOWN,"N/A":te}[e.currentTarget.value]||te)}},{key:"onEditLocation",value:function(e){var t=e.currentTarget.value.trim();e.currentTarget.checkValidity()?t.match(/^[nN]\s*\/?\s*[aA]$/)||!t?this.onMakeEdit("Location",te):this.onMakeEdit("Location",ne.Location(t)):this.onRemoveEdit("Location")}},{key:"onEditYear",value:function(e){this.onMakeEdit("Year",{"High school student":ee.Enum.YEAR.HIGH_SCHOOL,"First year college student":ee.Enum.YEAR.FIRST_YEAR,"Returning college student":ee.Enum.YEAR.COLLEGE,"Graduate Student":ee.Enum.YEAR.GRADUATE,"Transfer Student":ee.Enum.YEAR.TRANSFER,"N/A":te}[e.currentTarget.value]||te)}},{key:"onEditPar1Education",value:function(e){this.onMakeEdit("Parent1_Education",{"No HS diploma":ee.Enum.PARENT1_EDUCATION.NO_DIPLOMA,"HS diploma or equivalent":ee.Enum.PARENT1_EDUCATION.DIPLOMA,"Some college":ee.Enum.PARENT1_EDUCATION.SOME_COLLEGE,"College degree":ee.Enum.PARENT1_EDUCATION.DEGREE,"Multiple degrees":ee.Enum.PARENT1_EDUCATION.MULTIPLE_DEGREES,"No parent 1":ee.Enum.PARENT2_EDUCATION.NO_PARENT,"N/A":te}[e.currentTarget.value]||te)}},{key:"onEditPar2Education",value:function(e){this.onMakeEdit("Parent2_Education",{"No HS diploma":ee.Enum.PARENT2_EDUCATION.NO_DIPLOMA,"HS diploma or equivalent":ee.Enum.PARENT2_EDUCATION.DIPLOMA,"Some college":ee.Enum.PARENT2_EDUCATION.SOME_COLLEGE,"College degree":ee.Enum.PARENT2_EDUCATION.DEGREE,"Multiple degrees":ee.Enum.PARENT2_EDUCATION.MULTIPLE_DEGREES,"No parent 2":ee.Enum.PARENT2_EDUCATION.NO_PARENT,"N/A":te}[e.currentTarget.value]||te)}},{key:"onEditBirthday",value:function(e){var t=e.currentTarget.value.trim().toLowerCase();if(e.currentTarget.checkValidity())if(t.match(/^[nN]\s*\/?\s*[aA]$/)||!t)this.onMakeEdit("Birthday",te);else{var a,n,i,s,l,o,r=new Date;(a=t.match(/(\d+)\s*[\/\.-]\s*(\d+)\s*[\/\.-]\s*(\d+)/))?(p=+a[1],l=+a[2],n=+a[3],i=r.getFullYear(),s=100*Math.floor(i/100),n<100&&(n<i%100||!(i%100<n)&&(p<r.getMonth()+1||!(p>r.getMonth()+1)&&l<r.getDate())?n+=s:n+=s-100),12<p&&l<=12&&(p=(o=[l,p])[0],l=o[1])):(a=t.match(/^([a-z]+)\s*(?:\.\s*)?(\d{1,2})\s*(?:,\s*)?(\d{4})$/))&&(p=1==(t=(o=["january","february","march","april","may","june","july","august","september","october","november","december"]).filter(function(e){return 0==e.indexOf(a[1])})).length?o.indexOf(t[0])+1:0,l=+a[2],n=+a[3]);var c=n%400==0||n%4==0&&n%100!=0;switch(p){case 0:case 2:case 4:case 6:case 7:case 9:case 11:l=l<=31?l:0;break;case 3:case 5:case 8:case 10:break;case 1:l=l<=(c?29:28)?l:0}if(0<p&&p<=12&&0!=l){var p=new Date(n,p-1,l);if(p.valueOf())return this.onMakeEdit("Birthday",p),void e.currentTarget.removeAttribute("aria-invalid")}this.onRemoveEdit("Birthday",te),e.currentTarget.setAttribute("aria-invalid","")}else this.onRemoveEdit("Birthday")}},{key:"onEditPhoneNumber",value:function(e){var t=e.currentTarget.value.trim();e.currentTarget.checkValidity()?t.match(/^[nN]\s*\/?\s*[aA]$/)||!t?this.onMakeEdit("Phone",te):this.onMakeEdit("Phone",ne.Phone(t)):this.onRemoveEdit("Phone")}},{key:"onEditPronouns",value:function(e){var t=e.currentTarget.value.trim();e.currentTarget.checkValidity()?t.match(/^[nN]\s*\/?\s*[aA]$/)||!t?this.onMakeEdit("Pronouns",te):this.onMakeEdit("Pronouns",ne.Pronouns(t)):this.onRemoveEdit("Pronouns")}},{key:"onEditPrompt",value:function(e){var t=e.currentTarget.getAttribute("data-index");e.currentTarget.checkValidity()?this.onMakeEdit("Prompt"+t,e.currentTarget.value.trim()):this.onRemoveEdit("Prompt"+t)}},{key:"onEditComments",value:function(e){e.currentTarget.checkValidity()?this.onMakeEdit("Comments",e.currentTarget.value.trim()):this.onRemoveEdit("Comments")}}]),a}(),D=function(){_inherits(a,k);var t=_createSuper(a);function a(e){return _classCallCheck(this,a),t.call(this,e)}return _createClass(a,[{key:"render",value:function(){return this.props.floatingRow.active?React.createElement(C,_extends({},this.props.floatingRow.props,{floatingRow:this.props.floatingRow,isFloating:!0})):null}}]),a}(),ie=function(){_inherits(n,k);var a=_createSuper(n);function n(e){var t;return _classCallCheck(this,n),(t=a.call(this,e)).state={value:e.defaultValue||"",ref:React.createRef()},t.onChange=t.props.onChange?t.props.onChange.bind(_assertThisInitialized(t)):function(){},t.oldValue=e.defaultValue||"",t}return _createClass(n,[{key:"render",value:function(){return React.createElement("textarea",{ref:this.state.ref,value:this.state.value,onInput:this.onNewValue.bind(this),rows:"1"})}},{key:"componentDidMount",value:function(){this.onNewValue(!1)}},{key:"onNewValue",value:function(e){var t=this.state.ref.current;this.setState({value:t.value});var a=getComputedStyle(t);t.style.height="",t.style.height=t.scrollHeight+parseFloat(a.borderBottomWidth)+"px",e&&this.oldValue!=t.value&&(this.onChange(e),this.oldValue=t.value)}}]),n}();user.readProfile.then(function(e){ReactDOM.render(React.createElement(T,{years:S}),document.getElementById("content"))}),gapiLoaded.catch(function(e){document.getElementById("content").style.display="none",document.getElementById("gapi-failed").style.display="flex",document.getElementById("page-reload").addEventListener("click",location.reload.bind(location))})}();